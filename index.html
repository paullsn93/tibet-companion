<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <script>
        (function () {
            // ÂÅµÊ∏¨ÊòØÂê¶ÁÇ∫ LINE ÂÖßÂª∫ÁÄèË¶ΩÂô®
            var isLine = /Line/i.test(navigator.userAgent);
            // ÂÅµÊ∏¨Á∂≤ÂùÄÊòØÂê¶Â∞öÊú™ÂåÖÂê´Ë∑≥ËΩâÂèÉÊï∏
            var isNotExternal = window.location.href.indexOf("openExternalBrowser=1") === -1;

            if (isLine && isNotExternal) {
                // Â¶ÇÊûúÊòØÂú® LINE Ë£°Èù¢Ôºå‰∏îÈÇÑÊ≤íÂä†ÂèÉÊï∏ÔºåÂ∞±Âº∑Âà∂Âä†‰∏äÂèÉÊï∏‰∏¶ÈáçÊñ∞Â∞éÂêë
                var newUrl = window.location.href;
                if (newUrl.indexOf("?") > -1) {
                    newUrl += "&openExternalBrowser=1";
                } else {
                    newUrl += "?openExternalBrowser=1";
                }
                window.location.replace(newUrl);
            }
        })();
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tibet Companion</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0f172a;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }

        /* Drawer Transition */
        .drawer-enter-active,
        .drawer-leave-active {
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }

        .drawer-enter-from,
        .drawer-leave-to {
            transform: translateY(100%);
            opacity: 0;
        }

        /* Backdrop Transition */
        .fade-enter-active,
        .fade-leave-active {
            transition: opacity 0.3s ease;
        }

        .fade-enter-from,
        .fade-leave-to {
            opacity: 0;
        }

        /* Breathing Guide Animations */
        @keyframes circlePulse {
            0% {
                transform: scale(1);
                opacity: 0.3;
            }

            33% {
                transform: scale(1);
                opacity: 0.3;
            }

            45% {
                transform: scale(2.5);
                opacity: 1;
            }

            66% {
                transform: scale(2.5);
                opacity: 1;
            }

            100% {
                transform: scale(1);
                opacity: 0.3;
            }
        }

        .breathing-circle {
            transition: all 4s ease-in-out;
        }

        .breathing-inhale {
            transform: scale(2.5);
            opacity: 1;
        }

        .breathing-hold {
            transform: scale(2.5);
            opacity: 1;
        }

        .breathing-exhale {
            transform: scale(1);
            opacity: 0.3;
        }

        .toolkit-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }
    </style>
</head>



<body
    class="bg-slate-950 text-slate-100 h-screen w-screen overflow-hidden flex flex-col items-center selection:bg-cyan-500/30 touch-none">

    <div id="app"
        class="w-full max-w-[1600px] h-full flex flex-col md:flex-row md:gap-8 md:p-8 relative overflow-hidden">
        <!-- Landing Page (V5.0) -->
        <div id="landing-page"
            class="fixed inset-0 z-[100] bg-black flex flex-col justify-center items-center text-white bg-[url('https://upload.wikimedia.org/wikipedia/commons/thumb/b/be/Potala_palace23.jpg/3840px-Potala_palace23.jpg')] bg-cover bg-center bg-no-repeat">
            <!-- Black Overlay Gradient -->
            <div class="absolute inset-0 bg-gradient-to-b from-black/40 via-black/20 to-black/80 z-0"></div>

            <!-- Content -->
            <div class="relative z-10 flex flex-col items-center text-center p-8 animate-fade-in-up">
                <h1 class="text-4xl md:text-5xl font-light tracking-[0.5em] mb-4 drop-shadow-2xl">Ë•øËóèÊóÖ‰º¥</h1>
                <h2 class="text-sm md:text-base opacity-80 tracking-[0.5em] mb-12 font-medium">TIBET COMPANION</h2>

                <div id="countdown-number"
                    class="text-8xl md:text-9xl font-bold text-white drop-shadow-2xl font-mono mb-6">
                    {{ countdown }}
                </div>

                <p id="countdown-text" class="text-xl md:text-2xl font-light tracking-wide text-slate-200">
                    Ë∑ùÈõ¢ 2026.03.27 Âá∫ÁôºÈÇÑÊúâ {{ countdown }} Â§©
                </p>

                <div class="mt-16 flex flex-col items-center gap-4">
                    <button @click="enterApp"
                        class="w-64 px-10 py-4 rounded-full border border-teal-500/30 bg-teal-500/10 backdrop-blur-md hover:bg-teal-500/20 text-teal-400 transition-all active:scale-95 flex items-center justify-center gap-3 group">
                        <span class="text-lg font-bold tracking-widest">ÈñãÂïüÊóÖÁ®ã Enter</span>
                        <span
                            class="material-icons-outlined group-hover:translate-x-1 transition-transform">arrow_forward</span>
                    </button>
                    <button @click="isManualOpen = true"
                        class="w-64 px-8 py-3 rounded-full border border-white/10 bg-white/5 backdrop-blur-sm hover:bg-white/10 text-white/70 transition-all active:scale-95 flex items-center justify-center gap-2">
                        <span class="material-icons-outlined text-xl">auto_stories</span>
                        <span class="text-base font-medium tracking-wider">‰ΩøÁî®ÊâãÂÜä Manual</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Desktop Sidebar (md:block hidden) -->
        <aside
            class="hidden md:flex flex-col w-[360px] h-full bg-slate-900/50 backdrop-blur-md border border-slate-800 rounded-3xl overflow-hidden shrink-0 shadow-2xl">
            <!-- Sidebar Header -->
            <div class="p-8 border-b border-slate-800 bg-slate-900/80">
                <h1
                    class="text-2xl font-black bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent flex items-center gap-2">
                    <span class="material-icons-outlined text-cyan-400 text-3xl">landscape</span>
                    Tibet Companion
                </h1>
                <p class="text-sm text-slate-500 mt-2 font-medium tracking-wide">Ë•øËóèÊóÖ‰º¥ 12Êó•Ë°åÁ®ãÂä©Êâã</p>
            </div>

            <!-- Sidebar List -->
            <div class="flex-1 overflow-y-auto p-4 space-y-3 custom-scrollbar sidebar-scroll">
                <button v-for="(day, idx) in itinerary" :key="idx" @click="selectDay(idx)"
                    class="w-full text-left p-4 rounded-xl transition-all flex items-center gap-4 group relative overflow-hidden"
                    :class="currentIndex === idx ? 'bg-cyan-900/20 border border-cyan-500/30' : 'hover:bg-slate-800/50 border border-transparent'">
                    <div v-if="currentIndex === idx" class="absolute left-0 top-0 bottom-0 w-1.5 bg-cyan-500"></div>
                    <div class="w-10 h-10 rounded-xl flex items-center justify-center shrink-0 font-mono font-bold text-lg transition-colors"
                        :class="currentIndex === idx ? 'bg-cyan-500 text-white shadow-lg shadow-cyan-500/20' : 'bg-slate-800 text-slate-400 group-hover:bg-slate-700 group-hover:text-slate-200'">
                        {{ day.day }}
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center justify-between">
                            <span class="text-base font-bold truncate"
                                :class="currentIndex === idx ? 'text-cyan-100' : 'text-slate-300 group-hover:text-white'">
                                {{ day.locations[day.locations.length - 1] }}
                            </span>
                        </div>
                        <div class="flex items-center gap-2 text-sm mt-1">
                            <span class="text-slate-500 group-hover:text-slate-400 truncate">{{ day.title }}</span>
                            <span
                                class="ml-auto px-2 py-0.5 rounded bg-slate-950 text-slate-400 font-mono border border-slate-800 whitespace-nowrap text-xs"
                                :class="{'text-amber-400 border-amber-900/30': day.altitude.sleep > 3500}">
                                {{ day.altitude.sleep }}m
                            </span>
                        </div>
                    </div>
                </button>
            </div>

            <!-- Sidebar Footer -->
            <div class="p-4 border-t border-slate-800 bg-slate-900/30 text-center">
                <button @click="resetToToday"
                    class="text-sm text-cyan-500 hover:text-cyan-400 font-bold tracking-wider uppercase flex items-center justify-center gap-2 w-full py-3 rounded-xl hover:bg-cyan-950/30 transition-colors">
                    <span class="material-icons-outlined text-lg">today</span>
                    Back to Today
                </button>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="flex-1 w-full h-full flex flex-col relative overflow-hidden">
            <!-- Scrollable Content Container (Crucial Fix: flex-1, overflow-y-auto, touch-scrolling) -->
            <!-- ADDED ID="main-content-scroll" to fix querySelector issue -->
            <div id="main-content-scroll"
                class="flex-1 overflow-y-auto overflow-x-hidden custom-scrollbar px-4 pt-4 md:px-0 md:pt-0 scroll-smooth touch-pan-y"
                style="-webkit-overflow-scrolling: touch; padding-bottom: 7rem;">
                <!-- Added pb-32 to prevent bottom nav from covering content -->
                <div class="max-w-4xl mx-auto space-y-8 md:space-y-10 md:pb-8">

                    <!-- Header Section -->
                    <header
                        class="text-center space-y-4 mt-6 md:mt-0 transition-all duration-300 cursor-pointer md:cursor-default active:scale-95 md:active:scale-100 group flex-none"
                        v-if="currentDay" @click="width < 768 ? isDrawerOpen = true : null">
                        <!-- Top Info Bar + Menu Trigger -->
                        <div class="flex items-center justify-center gap-3 relative">
                            <!-- Menu Trigger (Mobile) -->
                            <div
                                class="md:hidden inline-flex items-center gap-2 px-4 py-2 rounded-full bg-slate-900 border border-slate-800 text-base text-slate-300 font-mono tracking-wide shadow-lg">
                                <span class="material-icons-outlined text-xl">menu</span>
                                {{ currentDay.date }}
                                <span v-if="isToday" class="text-emerald-400 font-bold ml-2 animate-pulse">‚óè</span>
                            </div>

                            <!-- Toolkit Button/Grid (V9.0) -->
                            <button @click.stop="toggleToolkit"
                                class="w-12 h-12 flex items-center justify-center rounded-full bg-slate-800 border border-slate-700 text-teal-400 hover:text-white hover:bg-slate-700 active:scale-95 transition-all shadow-lg">
                                <span class="material-icons-outlined text-2xl">widgets</span>
                            </button>

                            <!-- Map Button (V11.1 Dynamic) -->
                            <button v-if="mapButtonInfo" @click.stop="openMap(currentDay)"
                                class="inline-flex items-center gap-2 px-6 py-2 rounded-full bg-teal-600 hover:bg-teal-500 text-white text-base md:text-lg font-bold shadow-lg shadow-teal-500/20 active:scale-95 transition-all">
                                <span class="material-icons-outlined text-xl">{{ mapButtonInfo.icon }}</span>
                                {{ mapButtonInfo.label }}
                            </button>
                        </div>

                        <!-- Outdoor Mode: HUGE Titles -->
                        <h1
                            class="text-5xl md:text-7xl lg:text-8xl font-black bg-gradient-to-br from-white via-slate-200 to-slate-500 bg-clip-text text-transparent drop-shadow-xl flex items-center justify-center gap-3 py-4 md:py-6 tracking-tight leading-none">
                            Day {{ currentDay.day }}
                            <span
                                class="material-icons-outlined text-slate-600 text-5xl group-hover:text-cyan-400 transition-colors md:hidden">expand_more</span>
                        </h1>


                        <div class="flex items-center justify-center gap-3 text-cyan-400/90 font-medium">
                            <span class="material-icons-outlined text-3xl">place</span>
                            <span class="text-2xl md:text-4xl tracking-wide font-bold">{{ formattedLocations }}</span>
                        </div>

                        <p
                            class="text-slate-300 text-xl md:text-2xl font-medium border-t border-slate-800/80 pt-6 mx-4 md:mx-20 leading-relaxed tracking-wide min-h-[3rem]">
                            {{ currentDay.title }}</p>

                        <!-- V11.4 Day 8 Specific Route Warning -->
                        <div v-if="currentDay.day === 8"
                            class="mx-4 md:mx-20 mt-4 p-4 rounded-2xl bg-amber-950/30 border border-amber-500/30 text-amber-200 text-lg md:text-xl font-bold flex items-center justify-center gap-2">
                            <span class="material-icons-outlined text-amber-500">warning</span>
                            ‚ö†Ô∏è ÁôæÂ∫¶Âú∞ÂúñÈ†êË®≠ÂèØËÉΩÊúÉÂ∞éËà™Á∂ìÊãâËñ©ÁöÑÈ´òÈÄüÂÖ¨Ë∑ØÔºåÂØ¶ÈöõË°åÁ®ãÂ∞áËµ∞ S304 Èõ™Âè§ÊãâÂ±±ÊôØËßÄÂÖ¨Ë∑Ø„ÄÇ
                        </div>

                        <!-- V11.4 Day 10 Specific Railway Warning -->
                        <div v-if="currentDay.day === 10"
                            class="mx-4 md:mx-20 mt-4 p-4 rounded-2xl bg-blue-950/30 border border-blue-500/30 text-blue-200 text-lg md:text-xl font-bold flex items-center justify-center gap-2">
                            <span class="material-icons-outlined text-blue-400">directions_railway</span>
                            *Ë∑ØÂæëÁÇ∫ÈùíËóèÂÖ¨Ë∑Ø (G109)ÔºåËàáÈêµË∑ØÈ´òÂ∫¶Âπ≥Ë°åÔºå‰æõË∑ØÁ∑öÂèÉËÄÉ„ÄÇ
                        </div>
                    </header>

                    <!-- Loading / Error States -->
                    <div v-if="loading" class="flex flex-col items-center justify-center h-64 gap-6 text-slate-500">
                        <div class="w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin">
                        </div>
                        <p class="text-xl font-mono">ËºâÂÖ•Ë°åÁ®ãË≥áÊñô‰∏≠...</p>
                    </div>

                    <div v-else-if="error"
                        class="bg-red-950/30 border border-red-900/50 p-8 rounded-3xl text-center space-y-4 mx-4">
                        <span class="material-icons-outlined text-red-500 text-6xl">error_outline</span>
                        <h3 class="text-red-400 text-3xl font-bold">ÁÑ°Ê≥ïËÆÄÂèñË≥áÊñô</h3>
                        <p class="text-red-300/70 text-lg">{{ error }}</p>
                    </div>

                    <!-- Dashboard Grid (md:grid-cols-2) -->
                    <div v-else-if="currentDay" class="space-y-8 md:space-y-0 md:grid md:grid-cols-2 md:gap-8 w-full">

                        <!-- Flight Widget (V4.0) - Reorganized -->
                        <div v-if="currentDay.flight"
                            class="md:col-span-2 mb-0 bg-teal-950/30 border border-teal-500/30 rounded-3xl p-6 relative overflow-hidden group">
                            <!-- Background Decor -->
                            <div class="absolute -right-6 -top-6 text-teal-500/5 rotate-12 pointer-events-none">
                                <span class="material-icons-outlined text-9xl">flight</span>
                            </div>

                            <div class="flex flex-col md:flex-row md:items-end justify-between gap-6 relative z-10">
                                <!-- Left: Dep -->
                                <div
                                    class="flex flex-row md:flex-col items-center md:items-start justify-between md:justify-start gap-4 md:gap-0 w-full md:w-auto">
                                    <div class="text-teal-400 font-bold text-sm tracking-widest uppercase mb-1">
                                        Departure</div>
                                    <div class="text-4xl md:text-5xl font-black text-white font-mono tracking-tighter">
                                        {{ currentDay.flight.dep }}</div>
                                    <div
                                        class="text-slate-400 font-medium text-lg mt-1 px-3 py-1 bg-slate-900/50 rounded-lg inline-block">
                                        {{ currentDay.flight.from }}
                                    </div>
                                </div>

                                <!-- Center: Icon & Duration -->
                                <div
                                    class="hidden md:flex flex-col items-center justify-end pb-2 px-4 flex-1 self-center">
                                    <div class="flex items-baseline gap-2 mb-3">
                                        <div
                                            class="text-slate-400 text-sm md:text-base font-bold uppercase tracking-wider opacity-100">
                                            {{
                                            currentDay.flight.airline || 'Ëà™Á©∫ÂÖ¨Âè∏' }}</div>
                                        <div class="text-teal-500 font-mono font-bold text-lg leading-none">{{
                                            currentDay.flight.code }}</div>
                                    </div>
                                    <div
                                        class="w-full h-0.5 bg-gradient-to-r from-transparent via-teal-500/50 to-transparent relative min-w-[100px]">
                                        <span
                                            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-slate-950 px-2 text-teal-400 rotate-90">
                                            <span class="material-icons-outlined text-xl">flight</span>
                                        </span>
                                    </div>
                                </div>

                                <!-- Mobile Center Divider -->
                                <div
                                    class="md:hidden flex items-center justify-center gap-4 py-2 border-t border-b border-teal-500/20">
                                    <div class="flex items-baseline gap-2">
                                        <div
                                            class="text-slate-500 text-sm font-bold uppercase tracking-wider opacity-100">
                                            {{
                                            currentDay.flight.airline || 'Ëà™Á©∫ÂÖ¨Âè∏' }}</div>
                                        <div class="text-teal-500 font-mono font-bold text-lg leading-none">{{
                                            currentDay.flight.code }}
                                        </div>
                                    </div>
                                    <span class="material-icons-outlined text-teal-400 rotate-90">flight</span>
                                </div>

                                <!-- Right: Arr -->
                                <div
                                    class="flex flex-row md:flex-col items-center md:items-end justify-between md:justify-end gap-4 md:gap-0 w-full md:w-auto text-right">
                                    <div
                                        class="text-teal-400 font-bold text-sm tracking-widest uppercase mb-1 md:hidden">
                                        Arrival</div>
                                    <div class="text-4xl md:text-5xl font-black text-white font-mono tracking-tighter">
                                        {{ currentDay.flight.arr }}</div>
                                    <div
                                        class="text-slate-400 font-medium text-lg mt-1 px-3 py-1 bg-slate-900/50 rounded-lg inline-block">
                                        {{ currentDay.flight.to }}
                                    </div>
                                    <div
                                        class="text-teal-400 font-bold text-sm tracking-widest uppercase mt-1 hidden md:block">
                                        Arrival</div>
                                </div>
                            </div>
                        </div>

                        <!-- Altitude Card -->
                        <div
                            class="bg-slate-900/80 backdrop-blur-sm rounded-[2.5rem] p-8 md:p-10 shadow-2xl border border-slate-800 relative overflow-hidden h-full">
                            <div v-if="isHighAltitude"
                                class="absolute top-0 right-0 bg-red-500/20 text-red-400 text-sm px-5 py-2.5 rounded-bl-3xl font-bold border-l border-b border-red-500/30 flex items-center gap-2 backdrop-blur-md z-10">
                                <span class="material-icons-outlined text-lg animate-pulse">warning</span>
                                È´òÊµ∑ÊãîÊ≥®ÊÑè
                            </div>

                            <h3
                                class="text-slate-500 text-base font-bold uppercase tracking-[0.2em] mb-8 flex items-center gap-3">
                                <span class="material-icons-outlined text-2xl">landscape</span>
                                Êµ∑ÊãîÁõ£Êéß Altitude
                            </h3>

                            <div class="space-y-8"> <!-- Stacked layout for mobile clarity, or grid -->
                                <div class="grid grid-cols-1 gap-6">
                                    <div class="text-center p-8 bg-slate-950 rounded-3xl border border-slate-800/50">
                                        <div class="text-sm text-slate-500 uppercase tracking-widest mb-2 font-bold">
                                            ÊúÄÈ´ò
                                            (Max)</div>
                                        <div class="font-mono font-black tracking-tight leading-none" :class="[
                                                currentDay.altitude.max > 3500 ? 'text-amber-400' : 'text-slate-200',
                                                'text-7xl md:text-8xl'
                                             ]">
                                            {{ currentDay.altitude.max }}<span
                                                class="text-2xl ml-2 text-slate-600 font-bold align-baseline">m</span>
                                        </div>
                                    </div>

                                    <div class="text-center p-8 bg-slate-950 rounded-3xl border border-slate-800/50">
                                        <div class="text-sm text-slate-500 uppercase tracking-widest mb-2 font-bold">
                                            ‰ΩèÂÆø
                                            (Sleep)</div>
                                        <div class="font-mono font-black tracking-tight leading-none" :class="[
                                                currentDay.altitude.sleep > 3000 ? 'text-red-400' : 'text-emerald-400',
                                                'text-7xl md:text-8xl'
                                             ]">
                                            {{ currentDay.altitude.sleep }}<span
                                                class="text-2xl ml-2 text-slate-600 font-bold align-baseline">m</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Weather Card -->
                        <!-- Wear card -->
                        <div class="bg-slate-800/80 rounded-[2.5rem] p-6 shadow-xl border border-slate-700/50">
                            <h3
                                class="text-slate-400 text-sm md:text-base font-bold uppercase tracking-[0.2em] mb-4 flex items-center gap-2">
                                <span class="material-icons-outlined text-teal-500 text-xl">checkroom</span>
                                Á©øË°£ÊåáÂºï Wear
                            </h3>

                            <!-- Upper: Live Weather -->
                            <div v-if="liveWeather && !weatherLoading"
                                class="flex items-center justify-between mb-4 bg-slate-900/50 p-4 rounded-2xl border border-teal-500/10">
                                <div class="text-3xl font-bold text-white">{{ liveWeather.temp }}¬∞C</div>
                                <div class="flex items-center gap-1 text-slate-300 font-bold">
                                    <span class="material-icons-outlined text-cyan-400 text-sm">umbrella</span>
                                    <span>{{ liveWeather.rain }}%</span>
                                </div>
                            </div>

                            <!-- Loading state -->
                            <div v-if="weatherLoading" class="flex items-center justify-center py-4">
                                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-teal-500"></div>
                            </div>

                            <!-- Lower: Static Advice -->
                            <p class="text-slate-100 text-lg md:text-xl leading-relaxed font-medium">
                                {{ currentDay.weather_advice }}
                            </p>
                        </div>

                        <!-- Highlights (Spans 2 columns on Desktop) -->
                        <div
                            class="bg-slate-900/80 backdrop-blur-sm rounded-[2.5rem] p-8 md:p-10 shadow-2xl border border-slate-800 md:col-span-2">
                            <h3
                                class="text-slate-500 text-base font-bold uppercase tracking-[0.2em] mb-6 flex items-center gap-3">
                                <span class="material-icons-outlined text-2xl text-purple-400">auto_awesome</span>
                                ‰ªäÊó•‰∫ÆÈªû Highlights
                            </h3>
                            <ul class="grid md:grid-cols-2 gap-6">
                                <li v-for="(item, idx) in currentDay.highlights" :key="idx"
                                    class="flex items-start gap-5 group/item bg-slate-800/30 rounded-2xl p-6 transition-colors hover:bg-slate-800/50">
                                    <div
                                        class="mt-2 w-3 h-3 rounded-full bg-purple-500 shadow-[0_0_10px_rgba(168,85,247,0.6)] shrink-0">
                                    </div>
                                    <div class="flex-1">
                                        <a v-if="item.url" :href="item.url" target="_blank"
                                            class="text-purple-300 hover:text-purple-200 text-xl md:text-2xl leading-relaxed font-medium transition-colors underline decoration-purple-500/30 hover:decoration-purple-400 underline-offset-4">
                                            {{ item.label }}
                                            <span
                                                class="material-icons-outlined text-base align-middle ml-1 opacity-70">open_in_new</span>
                                        </a>
                                        <span v-else
                                            class="text-slate-200 text-xl md:text-2xl leading-relaxed font-medium">
                                            {{ item.label }}
                                        </span>
                                    </div>
                                </li>
                            </ul>

                            <!-- Detailed Description Accordion -->
                            <details v-if="currentDay.description"
                                class="mt-8 group/accordion border-t border-slate-700/50 pt-4">
                                <summary
                                    class="list-none flex items-center gap-2 text-slate-400 hover:text-cyan-400 cursor-pointer transition-colors font-bold select-none text-xl md:text-2xl">
                                    <span
                                        class="material-icons-outlined transition-transform group-open/accordion:rotate-90 text-2xl md:text-3xl">chevron_right</span>
                                    üìñ Êü•ÁúãÂÆåÊï¥Ë°åÁ®ã (Read More)
                                </summary>
                                <div class="mt-4 text-slate-300 space-y-4 leading-loose tracking-wide text-2xl bg-slate-900/50 p-6 rounded-2xl prose prose-invert prose-lg max-w-none"
                                    v-html="currentDay.description"></div>
                            </details>
                        </div>

                        <!-- Safety Tips (Spans 2 columns on Desktop) -->
                        <div
                            class="bg-gradient-to-br from-amber-950/40 to-orange-950/20 rounded-[2.5rem] p-8 md:p-10 shadow-2xl border border-amber-900/40 relative overflow-hidden md:col-span-2">
                            <div class="absolute top-0 right-0 p-8 opacity-10 pointer-events-none">
                                <span class="material-icons-outlined text-9xl text-amber-500">lightbulb</span>
                            </div>
                            <h3
                                class="text-amber-500/90 text-base font-bold uppercase tracking-[0.2em] mb-6 flex items-center gap-3 relative z-10">
                                <span class="material-icons-outlined text-2xl">tips_and_updates</span>
                                Ë≤ºÂøÉÂèÆÂöÄ Tips
                            </h3>
                            <p
                                class="text-amber-50 text-xl md:text-2xl leading-loose font-medium relative z-10 tracking-wide">
                                {{ currentDay.tips || '‰ªäÊó•Âãï‰ΩúË´ãÊîæÊÖ¢ÔºåÂ§öÂñùÊ∞¥ÔºåÂ§ö‰ºëÊÅØ„ÄÇ' }}
                            </p>
                        </div>

                        <!-- Health Tracker (Spans 2 columns on Desktop) -->
                        <div class="bg-slate-800 rounded-[2.5rem] p-6 shadow-2xl border border-slate-700 md:col-span-2">
                            <div class="flex justify-between items-center mb-6 px-2">
                                <h3
                                    class="text-base md:text-xl font-bold text-slate-200 flex items-center gap-2 md:gap-3">
                                    <span
                                        class="material-icons-outlined text-red-500 text-lg md:text-2xl">favorite</span>
                                    ÂÅ•Â∫∑Áõ£Êéß (Health Log)
                                </h3>
                                <button @click="copyHealthRecords"
                                    class="flex items-center gap-2 text-slate-400 hover:text-cyan-400 transition-colors bg-slate-900/50 px-4 py-2 rounded-xl text-sm font-bold border border-slate-700/50">
                                    <span class="material-icons-outlined text-lg">content_copy</span>
                                    Ë§áË£Ω
                                </button>
                            </div>

                            <!-- Input Group -->
                            <div class="grid grid-cols-3 gap-4 mb-8">
                                <div class="relative">
                                    <input v-model.number="newSpo2" type="number" placeholder="Ë°ÄÊ∞ßÊøÉÂ∫¶"
                                        class="w-full bg-slate-900 border border-slate-600 rounded-2xl px-4 py-4 text-2xl text-white placeholder-slate-600 focus:outline-none focus:border-cyan-500 transition-colors text-center font-mono font-bold">
                                    <span
                                        class="absolute right-3 bottom-3 text-xs text-slate-500 pointer-events-none font-bold">
                                        %</span>
                                </div>
                                <div class="relative">
                                    <input v-model.number="newHr" type="number" placeholder="ÂøÉÁéá"
                                        class="w-full bg-slate-900 border border-slate-600 rounded-2xl px-4 py-4 text-2xl text-white placeholder-slate-600 focus:outline-none focus:border-cyan-500 transition-colors text-center font-mono font-bold">
                                    <span
                                        class="absolute right-3 bottom-3 text-xs text-slate-500 pointer-events-none font-bold">
                                        bpm</span>
                                </div>
                                <button @click="addHealthRecord"
                                    class="bg-teal-600 hover:bg-teal-500 text-white rounded-2xl font-bold text-xl shadow-lg shadow-teal-900/50 active:scale-95 transition-all flex items-center justify-center">
                                    Ë®òÈåÑ
                                </button>
                            </div>

                            <!-- List Area -->
                            <div class="space-y-3 min-h-[100px]">
                                <div v-if="currentDateRecords.length === 0"
                                    class="text-center text-slate-500 py-6 text-lg font-medium border-2 border-dashed border-slate-700/50 rounded-2xl">
                                    Â∞öÁÑ°‰ªäÊó•Á¥ÄÈåÑ
                                </div>
                                <transition-group name="list" tag="div" class="space-y-3">
                                    <div v-for="record in currentDateRecords" :key="record.id"
                                        class="flex items-center justify-between bg-slate-900/80 rounded-2xl p-5 border border-slate-700/50 hover:border-slate-600 transition-colors">
                                        <div class="flex items-center gap-4 md:gap-8">
                                            <span class="text-slate-400 font-mono text-lg font-bold">{{ record.time
                                                }}</span>
                                            <div class="flex items-center gap-6">
                                                <div class="flex flex-col">
                                                    <span
                                                        class="text-[10px] text-slate-500 uppercase tracking-wider font-black">SpO2</span>
                                                    <span class="text-2xl font-mono font-black"
                                                        :class="record.spo2 < 80 ? 'text-red-500' : 'text-cyan-300'">{{
                                                        record.spo2 }}%</span>
                                                </div>
                                                <div class="flex flex-col">
                                                    <span
                                                        class="text-[10px] text-slate-500 uppercase tracking-wider font-black">HR</span>
                                                    <span class="text-2xl font-mono font-black text-slate-200">{{
                                                        record.hr
                                                        }}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <button @click="deleteHealthRecord(record.id)"
                                            class="text-slate-600 hover:text-red-400 p-3 bg-slate-800/50 rounded-xl transition-colors">
                                            <span class="material-icons-outlined text-xl">delete</span>
                                        </button>
                                    </div>
                                </transition-group>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bottom Navigation (Mobile Only) - Fixed to Bottom -->
                <footer
                    class="md:hidden flex-none fixed bottom-0 left-0 right-0 z-50 bg-slate-900/95 backdrop-blur-xl border-t border-slate-700 pb-safe-area shadow-[0_-4px_20px_rgba(0,0,0,0.5)]">
                    <div class="flex items-center justify-between p-3 max-w-md mx-auto w-full">
                        <button @click="changeDay(-1)" :disabled="currentIndex === 0"
                            class="w-12 h-12 rounded-full flex items-center justify-center transition-all bg-slate-800 text-slate-400 hover:bg-slate-700 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed active:scale-95 border border-slate-700">
                            <span class="material-icons-outlined text-2xl">arrow_back</span>
                        </button>

                        <div class="flex flex-col items-center select-none cursor-pointer active:scale-95 transition-transform px-6 py-1 rounded-2xl active:bg-slate-800"
                            @click="isDrawerOpen = true" role="button" title="ÈñãÂïüÂø´ÈÄüÈÅ∏ÂñÆ">
                            <span
                                class="text-[10px] uppercase tracking-[0.2em] text-slate-500 font-bold mb-0.5">DAY</span>
                            <span class="text-xl font-mono font-black text-slate-100 leading-none">{{ currentDay ?
                                currentDay.day : '-' }}<span class="text-sm text-slate-600 font-medium ml-1">/{{
                                    itinerary.length }}</span></span>
                        </div>

                        <button @click="changeDay(1)" :disabled="!currentDay || currentIndex === itinerary.length - 1"
                            class="w-12 h-12 rounded-full flex items-center justify-center transition-all bg-teal-600 text-white shadow-[0_2px_10px_rgba(13,148,136,0.3)] hover:bg-teal-500 disabled:opacity-30 disabled:cursor-not-allowed disabled:shadow-none active:scale-95 border border-teal-500">
                            <span class="material-icons-outlined text-2xl">arrow_forward</span>
                        </button>
                    </div>
                    <!-- Safe area padding for iPhone X+ -->
                    <div class="h-4 w-full md:hidden"></div>
                </footer>
        </main>

        <!-- Navigation Drawer (Mobile Only Modal) -->
        <teleport to="body">
            <!-- Backdrop -->
            <transition name="fade">
                <div v-if="isDrawerOpen && width < 768" @click="isDrawerOpen = false"
                    class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 md:hidden touch-none"></div>
            </transition>

            <!-- Drawer Content -->
            <transition name="drawer">
                <div v-if="isDrawerOpen && width < 768"
                    class="fixed bottom-0 left-0 right-0 bg-slate-900 rounded-t-[2.5rem] z-50 max-h-[85vh] h-[80vh] overflow-hidden flex flex-col shadow-[0_-4px_20px_rgba(0,0,0,0.5)] border-t border-slate-700 md:hidden pb-safe-area">
                    <!-- Drawer Handle -->
                    <div class="w-full flex justify-center pt-5 pb-3" @click="isDrawerOpen = false">
                        <div class="w-16 h-1.5 bg-slate-700 rounded-full"></div>
                    </div>

                    <!-- Drawer Header -->
                    <div class="px-8 py-4 border-b border-slate-800 flex justify-between items-center shrink-0">
                        <h2 class="text-2xl font-bold text-slate-200">Âø´ÈÄüË∑≥ËΩâ</h2>
                        <button @click="isDrawerOpen = false"
                            class="text-slate-400 hover:text-white transition-colors p-2 bg-slate-800/50 rounded-full">
                            <span class="material-icons-outlined text-2xl">close</span>
                        </button>
                    </div>

                    <!-- Scrollable List -->
                    <div class="flex-1 overflow-y-auto p-6 space-y-4 pb-12 custom-scrollbar touch-pan-y"
                        style="-webkit-overflow-scrolling: touch;">
                        <button v-for="(day, idx) in itinerary" :key="idx" @click="selectDay(idx)"
                            class="w-full text-left p-6 rounded-3xl transition-all flex items-center gap-5 group relative overflow-hidden"
                            :class="currentIndex === idx ? 'bg-cyan-900/30 border-2 border-cyan-500/50 shadow-[0_0_20px_rgba(8,145,178,0.3)]' : 'bg-slate-800/50 border-2 border-slate-800 hover:bg-slate-800'">
                            <div class="w-14 h-14 rounded-2xl flex items-center justify-center shrink-0 font-mono font-bold text-xl shadow-lg"
                                :class="currentIndex === idx ? 'bg-cyan-500 text-white' : 'bg-slate-700 text-slate-400 group-hover:bg-slate-600 group-hover:text-slate-200'">
                                {{ day.day }}
                            </div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="font-bold text-xl truncate pr-2"
                                        :class="currentIndex === idx ? 'text-cyan-100' : 'text-slate-300 group-hover:text-white'">
                                        {{ day.locations[day.locations.length - 1] }}
                                    </span>
                                    <span
                                        class="text-sm px-3 py-1 rounded-lg bg-slate-900 text-slate-400 font-mono border border-slate-700 font-bold">
                                        {{ day.altitude.sleep }}m
                                    </span>
                                </div>
                                <div class="text-base truncate w-full font-medium"
                                    :class="currentIndex === idx ? 'text-cyan-300/80' : 'text-slate-500 group-hover:text-slate-400'">
                                    {{ day.title }}
                                </div>
                            </div>
                            <span v-if="currentIndex === idx"
                                class="material-icons-outlined text-cyan-500 text-3xl font-bold">check</span>
                        </button>
                    </div>
                </div>
            </transition>
        </teleport>

        <!-- Packing List Modal (V4.0) -->
        <teleport to="body">
            <transition name="fade">
                <div v-if="isPackingListOpen"
                    class="fixed inset-0 bg-black/80 backdrop-blur-sm z-[60] flex items-center justify-center p-4"
                    @click.self="isPackingListOpen = false">
                    <div
                        class="bg-slate-900 w-full max-w-lg rounded-[2rem] shadow-2xl border border-slate-700 max-h-[85vh] flex flex-col overflow-hidden">
                        <!-- Modal Header -->
                        <div class="p-6 border-b border-slate-800 flex justify-between items-center bg-slate-900">
                            <h2 class="text-2xl font-bold text-white flex items-center gap-3">
                                <span class="material-icons-outlined text-teal-400">backpack</span>
                                Ë°åÊùéÊ∏ÖÂñÆ
                            </h2>
                            <button @click="isPackingListOpen = false"
                                class="text-slate-400 hover:text-white p-2 rounded-full hover:bg-slate-800 transition-colors">
                                <span class="material-icons-outlined text-2xl">close</span>
                            </button>
                        </div>

                        <!-- Modal Body (Scrollable) -->
                        <div class="flex-1 overflow-y-auto p-6 space-y-8 custom-scrollbar">
                            <div v-for="(category, catIdx) in packingList" :key="catIdx">
                                <h3
                                    class="text-teal-500 font-bold uppercase tracking-wider text-sm mb-4 sticky top-0 bg-slate-900 py-2 z-10">
                                    {{ category.name }}</h3>
                                <div class="space-y-3">
                                    <label v-for="(item, itemIdx) in category.items" :key="itemIdx"
                                        class="flex items-center gap-4 group cursor-pointer p-3 rounded-xl hover:bg-slate-800/50 transition-colors">
                                        <div class="relative flex items-center">
                                            <input type="checkbox"
                                                class="peer appearance-none w-6 h-6 border-2 border-slate-600 rounded-md checked:bg-teal-500 checked:border-teal-500 transition-colors"
                                                :checked="isPacked(category.name, item)"
                                                @change="togglePackingItem(category.name, item)">
                                            <span
                                                class="material-icons-outlined text-white absolute opacity-0 peer-checked:opacity-100 pointer-events-none text-lg left-0.5">check</span>
                                        </div>
                                        <span
                                            class="text-lg text-slate-300 font-medium peer-checked:text-slate-500 peer-checked:line-through transition-colors">{{
                                            item }}</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Modal Footer -->
                        <div class="p-6 border-t border-slate-800 bg-slate-900 text-center">
                            <p class="text-slate-500 text-sm">ÈÄ≤Â∫¶Ëá™ÂãïÂÑ≤Â≠òÊñºÊ≠§Ë£ùÁΩÆ</p>
                        </div>
                    </div>
                </div>
            </transition>
        </teleport>

        <!-- Toolkit Modal (V5.0) -->
        <teleport to="body">
            <transition name="fade">
                <div v-if="isToolkitOpen"
                    class="fixed inset-0 bg-black/80 backdrop-blur-sm z-[60] flex items-center justify-center p-4"
                    @click.self="toggleToolkit">
                    <div
                        class="bg-slate-900 w-full max-w-lg rounded-[2rem] shadow-2xl border border-slate-700 max-h-[85vh] flex flex-col overflow-hidden">
                        <!-- Modal Header -->
                        <div class="p-6 border-b border-slate-800 flex justify-between items-center bg-slate-900">
                            <h2 class="text-2xl font-bold text-white flex items-center gap-3">
                                <span class="material-icons-outlined text-cyan-400">construction</span>
                                ÂØ¶Áî®Â∑•ÂÖ∑
                            </h2>
                            <button @click="toggleToolkit"
                                class="text-slate-400 hover:text-white p-2 rounded-full hover:bg-slate-800 transition-colors">
                                <span class="material-icons-outlined text-2xl">close</span>
                            </button>
                        </div>

                        <!-- Modal Body (Scrollable) -->
                        <div class="flex-1 overflow-y-auto p-6 custom-scrollbar">
                            <div v-if="toolkitView === 'main'" class="grid grid-cols-2 gap-4">
                                <button @click="toolkitView = 'tour'"
                                    class="flex flex-col items-center justify-center p-6 bg-amber-600/50 border border-amber-500/30 rounded-2xl text-white text-lg font-bold shadow-lg hover:bg-amber-500/70 transition-all active:scale-95">
                                    <span class="material-icons-outlined text-4xl mb-2 text-amber-400">info</span>
                                    ÂúòÂãôËàáÁ¶èÂà©
                                </button>
                                <button @click="toolkitView = 'photo'"
                                    class="flex flex-col items-center justify-center p-6 bg-indigo-900/50 border border-indigo-800 rounded-2xl text-white text-lg font-bold shadow-lg hover:bg-indigo-800/70 transition-all active:scale-95">
                                    <span
                                        class="material-icons-outlined text-4xl mb-2 text-indigo-400">photo_camera</span>
                                    ÊîùÂΩ±ËàáÊ∞ë‰øó
                                </button>
                                <button @click="toolkitView = 'tibetan'"
                                    class="flex flex-col items-center justify-center p-6 bg-slate-800/50 border border-slate-700 rounded-2xl text-white text-lg font-bold shadow-lg hover:bg-slate-700/70 transition-all active:scale-95">
                                    <span class="material-icons-outlined text-4xl mb-2 text-slate-400">translate</span>
                                    ËóèË™ûÊïôÂ≠∏
                                </button>
                                <button @click="startBreathing"
                                    class="flex flex-col items-center justify-center p-6 bg-cyan-900/50 border border-cyan-800 rounded-2xl text-white text-lg font-bold shadow-lg hover:bg-cyan-800/70 transition-all active:scale-95">
                                    <span class="material-icons-outlined text-4xl mb-2 text-cyan-400">air</span>
                                    ÂëºÂê∏Á∑¥Áøí
                                </button>
                                <button @click="toolkitView = 'packing'"
                                    class="flex flex-col items-center justify-center p-6 bg-teal-900/50 border border-teal-800 rounded-2xl text-white text-lg font-bold shadow-lg hover:bg-teal-800/70 transition-all active:scale-95">
                                    <span class="material-icons-outlined text-4xl mb-2 text-teal-400">backpack</span>
                                    Ë°åÊùéÊ∏ÖÂñÆ
                                </button>
                            </div>

                            <!-- Tour Info View (V12.0) -->
                            <div v-if="toolkitView === 'tour'" class="space-y-8">
                                <h3 class="text-2xl font-black text-amber-400 mb-6 flex items-center gap-3">
                                    <span class="material-icons-outlined text-3xl">info</span>
                                    ÂúòÂãôËàáÁ¶èÂà© Tour Info
                                </h3>

                                <!-- A. Commitments -->
                                <div class="bg-amber-950/20 border border-amber-500/20 rounded-[2rem] p-8 space-y-8">
                                    <section>
                                        <h4 class="text-amber-100 font-black mb-4 flex items-center gap-3 text-2xl">
                                            <span class="material-icons-outlined text-2xl">payments</span>
                                            Â∞èË≤ªËàáË≥ºÁâ©
                                        </h4>
                                        <ul class="space-y-4 text-slate-200 text-xl font-medium">
                                            <li class="flex items-center gap-3">
                                                <span
                                                    class="material-icons-outlined text-emerald-400 text-xl">check_circle</span>
                                                Â∞èË≤ªÂÖ®ÂåÖ (Âê´Â∞éÈÅä/È†òÈöä)
                                            </li>
                                            <li class="flex items-center gap-3">
                                                <span
                                                    class="material-icons-outlined text-emerald-400 text-xl">check_circle</span>
                                                ÂÖ®Á®ãÁÑ°Ë≥ºÁâ©„ÄÅÁÑ°Ëá™Ë≤ªÂ£ìÂäõ
                                            </li>
                                        </ul>
                                    </section>

                                    <section>
                                        <h4 class="text-amber-100 font-black mb-4 flex items-center gap-3 text-2xl">
                                            <span class="material-icons-outlined text-2xl">redeem</span>
                                            Ë¥àÈÄÅÈ†ÖÁõÆ
                                        </h4>
                                        <ul class="space-y-5 text-slate-200">
                                            <li class="flex items-start gap-3">
                                                <span
                                                    class="material-icons-outlined text-emerald-400 text-xl mt-1">check_circle</span>
                                                <div>
                                                    <p class="font-bold text-xl">ÂÖçÁøªÁâÜÁ∂≤Âç°</p>
                                                    <p class="text-sm text-slate-400 mt-1">Ë´ãÁ¢∫Ë™çÊâãÊ©üÊòØÂê¶ÊîØÊè¥ÔºåÊäµÈÅîÂæåÂç≥ÂèØ‰ΩøÁî®„ÄÇ</p>
                                                </div>
                                            </li>
                                            <li class="flex items-start gap-3">
                                                <span
                                                    class="material-icons-outlined text-emerald-400 text-xl mt-1">check_circle</span>
                                                <div>
                                                    <p class="font-bold text-xl">Ê∞ßÊ∞£ÂÖÖË∂≥</p>
                                                    <p class="text-sm text-slate-400 mt-1">ÈÅäË¶ΩËªäÂÇôÊúâÈãºÁì∂Ê∞ßÊ∞£Ôºå‰∏¶Ë¥àÈÄÅÂÄã‰∫∫Èö®Ë∫´Ê∞ßÊ∞£Áì∂„ÄÇ</p>
                                                </div>
                                            </li>
                                            <li class="flex items-start gap-3">
                                                <span
                                                    class="material-icons-outlined text-emerald-400 text-xl mt-1">check_circle</span>
                                                <div>
                                                    <p class="font-bold text-xl">ÂìàÈÅîËøéË≥ì</p>
                                                    <p class="text-sm text-slate-400 mt-1">ÊäµÈÅîÊûóËäùÊ©üÂ†¥ÊôÇÔºå‰∫´ÊúâËóèÂºèÂìàÈÅîËøéË≥ìÁ¶Æ„ÄÇ</p>
                                                </div>
                                            </li>
                                        </ul>
                                    </section>
                                </div>

                                <!-- B. Emergency Contacts -->
                                <div class="bg-slate-800/50 border border-slate-700 rounded-[2rem] p-8">
                                    <h4 class="text-white font-black mb-6 flex items-center gap-3 text-2xl">
                                        <span class="material-icons-outlined text-red-500 text-2xl">phone_in_talk</span>
                                        Á∑äÊÄ•ËÅØÁµ° Contact
                                    </h4>
                                    <div class="space-y-5">
                                        <div
                                            class="flex justify-between items-center bg-slate-900/50 p-5 rounded-2xl border border-slate-700">
                                            <div>
                                                <p
                                                    class="text-sm text-slate-500 uppercase font-bold tracking-wider mb-1">
                                                    ÈòøÁé©ÊóÖÈÅä (Âè∞‰∏≠)</p>
                                                <p class="text-white text-2xl font-black font-mono">04-2382-1077</p>
                                            </div>
                                            <a href="tel:0423821077"
                                                class="w-12 h-12 flex items-center justify-center bg-indigo-600 hover:bg-indigo-500 rounded-full text-white transition-colors shadow-lg">
                                                <span class="material-icons-outlined text-2xl">call</span>
                                            </a>
                                        </div>
                                        <div
                                            class="p-6 bg-slate-900/30 rounded-2xl border border-dashed border-slate-700 text-center">
                                            <p class="text-slate-400 text-lg font-bold">È†òÈöä/Â∞éÈÅäÈõªË©±Ôºö</p>
                                            <p class="text-slate-500 italic mt-2 text-base">(Ë´ãÊñºÂá∫ÁôºË™™ÊòéÊúÉÂæåÊâãÂãïÂ°´ÂÖ•)</p>
                                        </div>
                                    </div>
                                </div>

                                <button @click="toolkitView = 'main'"
                                    class="w-full py-5 bg-slate-700 hover:bg-slate-600 text-white rounded-2xl font-black text-xl transition-all active:scale-95 shadow-lg">
                                    ËøîÂõûÂ∑•ÂÖ∑ÁÆ± Return
                                </button>
                            </div>

                            <!-- Photo & Culture View (V11.0) -->
                            <div v-if="toolkitView === 'photo'" class="space-y-6">
                                <h3 class="text-xl font-bold text-indigo-400 mb-4 flex items-center gap-2">
                                    <span class="material-icons-outlined">photo_camera</span>
                                    ÊîùÂΩ±ËàáÊ∞ë‰øó Photo & Culture
                                </h3>

                                <!-- A. Sunrise & Sunset -->
                                <div class="bg-indigo-950/30 border border-indigo-500/20 rounded-2xl p-6 space-y-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-3">
                                            <span
                                                class="material-icons-outlined text-amber-400 text-3xl">wb_sunny</span>
                                            <div>
                                                <p class="text-slate-400 text-sm uppercase tracking-wider">Sunrise</p>
                                                <p class="text-white text-3xl font-black font-mono">{{
                                                    liveWeather?.sunrise || '---' }}</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center gap-3 text-right">
                                            <div class="mr-1">
                                                <p class="text-slate-400 text-sm uppercase tracking-wider">Sunset</p>
                                                <p class="text-white text-3xl font-black font-mono">{{
                                                    liveWeather?.sunset || '---' }}</p>
                                            </div>
                                            <span
                                                class="material-icons-outlined text-orange-500 text-3xl">nights_stay</span>
                                        </div>
                                    </div>
                                    <div class="pt-4 border-t border-indigo-500/10">
                                        <p class="text-indigo-200 text-lg flex items-center gap-2">
                                            <span class="material-icons-outlined text-xl">lightbulb</span>
                                            ÈªÉÈáëÊôÇÂàªÔºöÊó•Âá∫Âæå/Êó•ËêΩÂâç 1 Â∞èÊôÇÔºåËâ≤Ê∫´ÊúÄÁæé„ÄÇ
                                        </p>
                                    </div>
                                </div>

                                <!-- B. Culture Do's & Don'ts -->
                                <div class="bg-slate-800/50 border border-slate-700 rounded-2xl p-6">
                                    <h4 class="text-white font-bold mb-4 flex items-center gap-2">
                                        <span class="material-icons-outlined text-amber-500">gavel</span>
                                        Ê∞ë‰øóÁ¶ÅÂøåÂ∞èÊäÑ
                                    </h4>
                                    <ul class="space-y-6">
                                        <li class="flex gap-4">
                                            <span class="text-indigo-400 font-bold text-xl shrink-0">1.</span>
                                            <p class="text-slate-200 text-lg leading-relaxed"><strong
                                                    class="text-white">ÂØ∫ÂªüÂÖßÁ¶ÅÊ≠¢ÊãçÁÖß</strong>ÔºöÊÆøÂÖß‰ΩõÂÉèËàáÂ£ÅÁï´ÈÄöÂ∏∏Âö¥Á¶ÅÊîùÂΩ±ÔºåË´ãÂ∞äÈáçË¶èÂÆö„ÄÇ</p>
                                        </li>
                                        <li class="flex gap-4">
                                            <span class="text-indigo-400 font-bold text-xl shrink-0">2.</span>
                                            <p class="text-slate-200 text-lg leading-relaxed"><strong
                                                    class="text-white">ËΩâÁ∂ìÊñπÂêë</strong>ÔºöÂèÉËßÄÂØ∫ÂªüÊàñËΩâÁ∂ìËº™ÊôÇÔºåË´ãÂãôÂøÖÈ†ÜÊôÇÈáùË°åÈÄ≤„ÄÇ</p>
                                        </li>
                                        <li class="flex gap-4">
                                            <span class="text-indigo-400 font-bold text-xl shrink-0">3.</span>
                                            <p class="text-slate-200 text-lg leading-relaxed"><strong
                                                    class="text-white">Êë∏È†≠Á¶ÅÂøå</strong>ÔºöË´ãÂãøÈö®ÊÑèËß∏Êë∏ËóèÊóè‰∫∫ÁöÑÈ†≠ÔºàÂåÖÊã¨Â∞èÂ≠©ÔºâÔºåÈÄôÊòØÁ•ûËÅñÈÉ®‰Ωç„ÄÇ</p>
                                        </li>
                                        <li class="flex gap-4">
                                            <span class="text-indigo-400 font-bold text-xl shrink-0">4.</span>
                                            <p class="text-slate-200 text-lg leading-relaxed"><strong
                                                    class="text-white">Á©∫ÊãçÊ©üË¶èÂÆö</strong>ÔºöÊãâËñ©Â∏ÇÂçÄÔºàÂ∏ÉÈÅîÊãâÂÆÆÂë®ÈÇäÔºâÂ±¨Á¶ÅÈ£õÂçÄÔºåËµ∑È£õÂâçË´ãÂÖàË©¢ÂïèÂ∞éÈÅä„ÄÇ</p>
                                        </li>
                                        <li class="flex gap-4">
                                            <span class="text-indigo-400 font-bold text-xl shrink-0">5.</span>
                                            <p class="text-slate-200 text-lg leading-relaxed"><strong
                                                    class="text-white">Â∞äÈáçÊúùËÅñËÄÖ</strong>ÔºöÊãçÊîùÊúùËÅñËÄÖÊôÇÔºåÂª∫Ë≠∞‰øùÊåÅË∑ùÈõ¢ÊàñÂÖàÈªûÈ†≠Á§∫ÊÑèÔºåÂãøË≤ºËáâÊãçÊîù„ÄÇ</p>
                                        </li>
                                    </ul>
                                </div>

                                <button @click="toolkitView = 'main'"
                                    class="w-full py-4 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold transition-colors">
                                    ËøîÂõûÂ∑•ÂÖ∑ÁÆ±
                                </button>
                            </div>

                            <!-- Tibetan Phrases View -->
                            <div v-if="toolkitView === 'tibetan'" class="space-y-4">
                                <h3 class="text-xl font-bold text-slate-300 mb-4">Â∏∏Áî®ËóèË™û</h3>
                                <div class="space-y-3">
                                    <div v-for="(phrase, idx) in tibetanPhrases" :key="idx"
                                        @click="fullscreenPhrase = phrase; speak(phrase)"
                                        class="p-4 bg-slate-800/50 border border-slate-700 rounded-xl cursor-pointer hover:bg-slate-700/70 transition-colors">
                                        <div class="flex justify-between items-center">
                                            <div>
                                                <p class="text-slate-400 text-sm">{{ phrase.ch }}</p>
                                                <p class="text-white text-lg font-bold">{{ phrase.tib }}</p>
                                                <p class="text-cyan-400 text-sm font-medium">ÁôºÈü≥: {{ phrase.pron }}</p>
                                            </div>
                                            <span class="material-icons-outlined text-slate-500">volume_up</span>
                                        </div>
                                    </div>
                                </div>
                                <button @click="toolkitView = 'main'"
                                    class="mt-6 w-full py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold transition-colors">
                                    ËøîÂõû
                                </button>
                            </div>

                            <!-- Breathing Exercise View -->
                            <div v-if="toolkitView === 'breathing'"
                                class="flex flex-col items-center justify-center h-full min-h-[300px] text-center">
                                <div class="breathing-circle w-48 h-48 rounded-full bg-cyan-700/50 flex items-center justify-center transition-all duration-300 ease-in-out"
                                    :class="breathingStateClass">
                                    <span class="material-icons-outlined text-white text-6xl">{{ breathingIcon }}</span>
                                </div>
                                <p class="text-cyan-300 text-3xl font-bold mt-8">{{ breathingText }}</p>
                                <p class="text-slate-400 text-lg mt-2">{{ breathingSubtext }}</p>
                                <button @click="stopBreathing"
                                    class="mt-8 py-3 px-6 bg-red-700 hover:bg-red-600 text-white rounded-xl font-bold transition-colors">
                                    ÂÅúÊ≠¢Á∑¥Áøí
                                </button>
                            </div>

                            <!-- Packing List View (Added for V9.3) -->
                            <div v-if="toolkitView === 'packing'" class="space-y-6">
                                <h3 class="text-xl font-bold text-emerald-400 mb-2 flex items-center gap-2">
                                    <span class="material-icons-outlined">backpack</span>
                                    Ë°åÊùéÊ∏ÖÂñÆ Checkbox
                                </h3>
                                <div v-for="(group, gIndex) in packingList" :key="group.category" class="space-y-3">
                                    <h4
                                        class="text-slate-400 text-xs font-bold uppercase tracking-wider flex items-center gap-2 mt-4 ml-1">
                                        <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full"></span>
                                        {{ group.category }}
                                    </h4>
                                    <div class="grid grid-cols-1 gap-2">
                                        <div v-for="(item, iIndex) in group.items" :key="item"
                                            @click="togglePackingItem(group.category, item)"
                                            class="p-4 rounded-xl border transition-all cursor-pointer flex items-center gap-3 select-none"
                                            :class="isPacked(group.category, item) ? 'bg-emerald-500/10 border-emerald-500/30 text-emerald-100' : 'bg-slate-800/50 border-slate-700/50 text-slate-300 hover:border-slate-500'">
                                            <span class="material-icons-outlined text-lg">
                                                {{ isPacked(group.category, item) ? 'check_circle' :
                                                'radio_button_unchecked' }}
                                            </span>
                                            <span class="font-medium">{{ item }}</span>
                                        </div>
                                    </div>
                                </div>
                                <button @click="toolkitView = 'main'"
                                    class="mt-8 w-full py-4 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold transition-colors">
                                    ËøîÂõûÂ∑•ÂÖ∑ÁÆ±
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </transition>
        </teleport>

        <!-- User Manual Modal (V10.0) -->
        <teleport to="body">
            <transition name="fade">
                <div v-if="isManualOpen"
                    class="fixed inset-0 z-[120] bg-slate-950/98 backdrop-blur-xl flex flex-col overflow-hidden">
                    <!-- Manual Header -->
                    <div
                        class="flex-none p-6 border-b border-white/5 flex items-center justify-between bg-slate-950/50">
                        <div class="flex items-center gap-3">
                            <span class="material-icons-outlined text-teal-400 text-3xl">auto_stories</span>
                            <h2 class="text-xl font-black tracking-widest uppercase">‰ΩøÁî®ÊâãÂÜä Manual</h2>
                        </div>
                        <button @click="isManualOpen = false"
                            class="p-2 rounded-full hover:bg-white/10 transition-colors">
                            <span class="material-icons-outlined">close</span>
                        </button>
                    </div>

                    <!-- Manual Content -->
                    <div class="flex-1 overflow-y-auto p-6 md:p-12 custom-scrollbar">
                        <div class="max-w-2xl mx-auto space-y-12 pb-20">
                            <!-- Intro -->
                            <section>
                                <h3 class="text-3xl font-bold text-white mb-6 flex items-center gap-3">
                                    <span class="text-teal-500">01</span> Ê≠°Ëøé‰ΩøÁî®
                                </h3>
                                <p class="text-slate-200 leading-relaxed text-2xl">
                                    „ÄåË•øËóèÊóÖ‰º¥„ÄçÊòØÂ∞àÁÇ∫ 12 Êó•Ë•øËóèÊ∑±Â∫¶ÊóÖÈÅäË®≠Ë®àÁöÑÊï∏‰ΩçÂä©Êâã„ÄÇÊàëÂÄëÊï¥Âêà‰∫ÜË°åÁ®ãÁÆ°ÁêÜ„ÄÅÊ∞£Ë±°Êõ¥Êñ∞„ÄÅÂÅ•Â∫∑ËøΩËπ§ËàáÂÆâÂÖ®Â∑•ÂÖ∑ÔºåÂä©ÊÇ®ÂÆâÂøÉÊé¢Á¥¢‰∏ñÁïåÂ±ãËÑä„ÄÇ
                                </p>
                            </section>

                            <!-- Feature 1: Itinerary -->
                            <section>
                                <h3 class="text-2xl font-bold text-white mb-4 flex items-center gap-3">
                                    <span class="text-teal-500">02</span> Ë°åÁ®ãÁÆ°ÁêÜËàáÊîªÁï•
                                </h3>
                                <div class="bg-slate-900/50 p-8 rounded-3xl border border-white/10 space-y-6 shadow-xl">
                                    <p class="text-white text-xl font-medium">ÊØè‰∏ÄÂ§©ÈÉΩÊúâÂ∞àÂ±¨ÁöÑÂ∫ßÊ®ô„ÄÅÊµ∑ÊãîËàáÊôØÈªûÁ∞°‰ªãÔºö</p>
                                    <ul class="list-disc list-inside text-slate-200 space-y-4 ml-4 text-xl">
                                        <li><strong class="text-teal-400">ÈñãÂïüÂú∞Âúñ</strong>Ôºö‰∏ÄÈçµÂ∞éËà™Ëá≥Áï∂Â§©ÁõÆÁöÑÂú∞„ÄÇ</li>
                                        <li><strong class="text-teal-400">Á≤æÈÅ∏ÊîªÁï•</strong>ÔºöÈªûÊìäÂ∏∂ÊúâÂ∫ïÁ∑öÁöÑÊôØÈªûÂêçÁ®±ÔºåÈñãÂïüÁé©ÂÆ∂Ë¶ñËßíÁöÑÂúñÊñá‰ªãÁ¥π„ÄÇ</li>
                                    </ul>
                                </div>
                            </section>

                            <!-- Feature 2: Weather & Health -->
                            <section>
                                <h3 class="text-3xl font-bold text-white mb-4 flex items-center gap-3">
                                    <span class="text-teal-500">03</span> Âç≥ÊôÇÂ§©Ê∞£ËàáÂÅ•Â∫∑Áõ£Êéß
                                </h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div class="bg-slate-900/50 p-8 rounded-3xl border border-white/10 shadow-xl">
                                        <h4 class="font-bold text-emerald-400 mb-3 text-2xl">Ê∞£Ë±°Á©øË°£</h4>
                                        <p class="text-lg text-slate-200 leading-relaxed">Â∞çÊé• Open-Meteo
                                            APIÔºåÈ°ØÁ§∫Áï∂ÂâçÈôçÈõ®Ê©üÁéáËàáÊ∞£Ê∫´Ôºå‰∏¶Êèê‰æõÂ∞àÊ•≠Á©øÊê≠Âª∫Ë≠∞„ÄÇ</p>
                                    </div>
                                    <div class="bg-slate-900/50 p-8 rounded-3xl border border-white/10 shadow-xl">
                                        <h4 class="font-bold text-cyan-400 mb-3 text-2xl">ÂÅ•Â∫∑ËøΩËπ§</h4>
                                        <p class="text-lg text-slate-200 leading-relaxed">ÊØèÊó•Ë®òÈåÑË°ÄÊ∞ß (SpO2)
                                            ËàáÂøÉÁéáÔºåÊîØÊè¥‰∏ÄÈçµË§áË£ΩÊï¥Êó•Êï∏ÊìöÁôºÈÄÅÁµ¶Ë¶™Âèã„ÄÇ</p>
                                    </div>
                                </div>
                            </section>

                            <!-- Feature 3: Toolkit -->
                            <section>
                                <h3 class="text-2xl font-bold text-white mb-4 flex items-center gap-3">
                                    <span class="text-teal-500">04</span> ÂÆâÂÖ®Â∑•ÂÖ∑ÁÆ± (V9.0+)
                                </h3>
                                <div
                                    class="bg-indigo-950/30 border border-indigo-500/20 rounded-2xl p-6 mb-8 flex items-start gap-4 shadow-xl">
                                    <span class="material-icons-outlined text-indigo-500 text-4xl">photo_camera</span>
                                    <div>
                                        <h5 class="font-bold text-white text-xl">ÊîùÂΩ±ËàáÊ∞ë‰øó (V11.0)</h5>
                                        <p class="text-lg text-slate-200">ÂØ¶ÊôÇÊü•Ë©¢Êó•Âá∫Êó•ËêΩÊôÇÈñìÔºå‰∏¶Êèê‰æõÊîùÂΩ±Âª∫Ë≠∞ËàáË•øËóèÊ∞ë‰øóÁ¶ÅÂøåÂ∞èÊäÑ„ÄÇ</p>
                                    </div>
                                </div>
                                <div class="space-y-8">
                                    <div class="flex items-start gap-4">
                                        <span class="material-icons-outlined text-amber-500 text-4xl">translate</span>
                                        <div>
                                            <h5 class="font-bold text-white text-xl">ËóèË™ûÂ≠óÂç°ËàáÁôºÈü≥</h5>
                                            <p class="text-lg text-slate-200">ÈªûÊìäÂ≠óÂç°ÂèØÂÖ®Ëû¢ÂπïÈ°ØÁ§∫‰∏¶ÁôºÂá∫ËóèÂºèË™ûË™øÔºåÊñπ‰æøÊ∫ùÈÄö„ÄÇ</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-4">
                                        <span class="material-icons-outlined text-cyan-500 text-4xl">air</span>
                                        <div>
                                            <h5 class="font-bold text-white text-xl">4-4-4 ÂëºÂê∏ÂºïÂ∞é</h5>
                                            <p class="text-lg text-slate-200">Ë∑üÈö®ÂúìÂúàÂæãÂãïÂê∏Ê∞£„ÄÅÊÜãÊ∞£„ÄÅÂêêÊ∞£ÔºåËÉΩÊúâÊïàÁ©©ÂÆöÂøÉË∑≥‰∏¶Á∑©Ëß£È´òÂéüÂèçÊáâ„ÄÇ</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-4">
                                        <span
                                            class="material-icons-outlined text-emerald-500 text-4xl">inventory_2</span>
                                        <div>
                                            <h5 class="font-bold text-white text-xl">‰∫íÂãïÂºèË°åÊùéÊ∏ÖÂñÆ</h5>
                                            <p class="text-lg text-slate-200">ÂÖßÂª∫ÂøÖÂÇôËó•ÂìÅËàáË£ùÂÇôÊ∏ÖÂñÆÔºåÊîØÊè¥ÂãæÈÅ∏‰∏¶Ëá™Âãï‰øùÂ≠òÊÇ®ÁöÑÊâìÂåÖÈÄ≤Â∫¶„ÄÇ</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-4">
                                        <span class="material-icons-outlined text-amber-500 text-4xl">info</span>
                                        <div>
                                            <h5 class="font-bold text-white text-xl">ÂúòÂãôËàáÁ¶èÂà© (V12.0)</h5>
                                            <p class="text-lg text-slate-200">ÂåÖÂê´ÈòøÁé©ÊóÖÈÅäÂ∞àÂ±¨Á¶èÂà©ÔºöÂÖçÁøªÁâÜÁ∂≤Âç°„ÄÅÊ∞ßÊ∞£Áì∂‰æõÊáâ„ÄÅÂ∞èË≤ªÂÖ®ÂåÖÊâøË´æÂèäÁ∑äÊÄ•ËÅØÁµ°‰∫∫Ë≥áË®ä„ÄÇ</p>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- Tips -->
                            <section class="bg-teal-500/10 p-8 rounded-[2.5rem] border border-teal-500/20 shadow-lg">
                                <h4 class="text-2xl font-bold text-teal-400 mb-4 items-center flex gap-2">
                                    <span class="material-icons-outlined">tips_and_updates</span>
                                    ÂÆâÂÖ®Â∞èÁ≠ÜË®ò
                                </h4>
                                <p class="text-teal-100/90 text-lg leading-relaxed">
                                    ÈÄ≤ËóèÂàùÊúüË´ãÈÅøÂÖçÂ§ßÂäõÊ¥ªÂãïËàáÈ†ªÁπÅÊ¥óÈ†≠„ÄÇËã•Ë°ÄÊ∞ß‰ΩéÊñº 80% ‰∏î‰º¥Èö®ÂäáÁÉàÈ†≠ÁóõÔºåË´ãÂãôÂøÖÁ´ãÂç≥Âê∏Ê∞ß‰∏¶ÈÄöÁü•È†òÈöä„ÄÇÁ•ùÊÇ®Âú®Èõ™ÂüüÈ´òÂéüÊìÅÊúâ‰∏ÄÊÆµÈõ£ÂøòÁöÑÁ¥îÁ≤πÊôÇÂÖâÔºÅ
                                </p>
                            </section>

                            <div class="flex flex-col items-center pt-8">
                                <button @click="isManualOpen = false"
                                    class="text-slate-400 hover:text-white transition-all underline underline-offset-8 text-lg">
                                    ÂõûÂà∞Â∞ÅÈù¢ Back to Home
                                </button>
                                <p class="text-slate-700 text-sm mt-12 font-mono uppercase tracking-[0.2em]">¬© 2026
                                    Tibet Companion v11.0</p>
                            </div>
                        </div>
                    </div>
                </div>
            </transition>
        </teleport>

        <!-- Fullscreen Phrase Display -->
        <teleport to="body">
            <transition name="fade">
                <div v-if="fullscreenPhrase"
                    class="fixed inset-0 bg-black/90 backdrop-blur-md z-[130] flex flex-col items-center justify-center p-4"
                    @click="fullscreenPhrase = null">
                    <div class="text-center">
                        <p class="text-slate-400 text-2xl mb-4">{{ fullscreenPhrase.ch }}</p>
                        <p class="text-white text-6xl font-black mb-6">{{ fullscreenPhrase.tib }}</p>
                        <p class="text-cyan-400 text-4xl font-bold">ÁôºÈü≥: {{ fullscreenPhrase.pron }}</p>
                        <p v-if="fullscreenPhrase.urgent" class="text-red-500 text-xl mt-8">üö® Á∑äÊÄ•Áî®Ë™û</p>
                    </div>
                    <button @click="fullscreenPhrase = null"
                        class="absolute top-6 right-6 text-slate-400 hover:text-white p-3 rounded-full hover:bg-slate-800 transition-colors">
                        <span class="material-icons-outlined text-3xl">close</span>
                    </button>
                </div>
            </transition>
        </teleport>
    </div><!-- End #app -->

    <style>
        /* Toolkit CSS */
        .breathing-circle {
            animation: breathe 12s infinite ease-in-out;
        }

        .breathing-inhale {
            transform: scale(1.2);
            background-color: #06b6d4;
            /* cyan-500 */
        }

        .breathing-hold {
            transform: scale(1.2);
            background-color: #0891b2;
            /* cyan-600 */
        }

        .breathing-exhale {
            transform: scale(0.8);
            background-color: #0e7490;
            /* cyan-700 */
        }

        @keyframes breathe {
            0% {
                transform: scale(1);
                background-color: #06b6d4;
            }

            /* Start (inhale) */
            33% {
                transform: scale(1.2);
                background-color: #0891b2;
            }

            /* Hold */
            66% {
                transform: scale(0.8);
                background-color: #0e7490;
            }

            /* Exhale */
            100% {
                transform: scale(1);
                background-color: #06b6d4;
            }

            /* Return to start */
        }
    </style>

    <script>
        // Landing Page Logic (V5.0)
        (function () {
            const landingPage = document.getElementById('landing-page');
            const countdownNumber = document.getElementById('countdown-number');
            const countdownText = document.getElementById('countdown-text');

            const targetDate = new Date('2026-03-27T00:00:00');
            const now = new Date();
            const diffTime = targetDate - now;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); // Round up for "days left"

            if (diffDays <= 0) {
                // Trip Started or Passed -> Hide Landing Page Immediately
                if (landingPage) landingPage.style.display = 'none';
            } else {
                // Show Countdown
                if (countdownNumber) countdownNumber.innerText = diffDays;
                if (countdownText) countdownText.innerText = `Ë∑ùÈõ¢ 2026.03.27 Âá∫ÁôºÈÇÑÊúâ ${diffDays} Â§©`;
            }
        })();

        function enterApp() {
            const landingPage = document.getElementById('landing-page');
            if (landingPage) {
                // Add fade-out transition
                landingPage.style.transition = 'opacity 1s ease-out';
                landingPage.style.opacity = '0';
                landingPage.style.pointerEvents = 'none'; // Prevent clicks during fade out

                // Reset to Day 1
                if (window.resetToDayOne) window.resetToDayOne();

                // Remove from DOM/Display None after transition
                setTimeout(() => {
                    landingPage.style.display = 'none';
                }, 1000);
            }
        }

        const { createApp, ref, computed, watch, onMounted, onUnmounted } = Vue;

        // Inline Data to Prevent Fetch Errors or CORS issues on Mobile Browsers
        const itineraryData = [
  {
    "day": 1,
    "date": "2026-03-27",
    "title": "ÂïüÁ®ãÔºöÂâçÂæÄËΩâÊ©üÈªû",
    "locations": [
      "Ê°ÉÂúí",
      "Ê∑±Âú≥"
    ],
    "altitude": {
      "avg": 50,
      "max": 100,
      "sleep": 50
    },
    "coords": {
      "lat": 22.5431,
      "lon": 114.0579
    },
    "weather_advice": "ËàíÈÅ© (20¬∞C)ÔºåÁ©øËëóËºï‰æø„ÄÇ",
    "stay": "Ê∑±Âú≥Âá±ÊÇÖÂòâËªíÈÖíÂ∫ó",
    "tips": "‰ªäÊôöË´ãÊó©Èªû‰ºëÊÅØÔºåÊòéÂ§©‰∏ÄÊó©Ë¶ÅÈ£õÂæÄÈ´òÂéü„ÄÇÈòøÁé©ÊóÖÈÅäÊâøË´æÔºöËã•Áï∂Âú∞ÁÑ°Á¥†È£üÈ§êÂª≥ÔºåÂ∞áÊúÉÂÆâÊéí‰∏ÄËà¨È§êÂª≥‰∏¶„ÄåÂÆ¢Ë£ΩÂåñÁ¥†È£üÈ§êÈªû„ÄçÔºåË´ãÊîæÂøÉÁî®È§ê„ÄÇ",
    "map_url": "https://www.google.com/maps/search/?api=1&query=Ê∑±Âú≥Âá±ÊÇÖÂòâËªíÈÖíÂ∫ó",
    "route": {
      "end": "Ê∑±Âú≥ÂÆùÂÆâÂõΩÈôÖÊú∫Âú∫",
      "mode": "flight"
    },
    "flight": {
      "code": "CZ3088",
      "from": "TPE Ê°ÉÂúí",
      "to": "SZX Ê∑±Âú≥",
      "dep": "13:40",
      "arr": "15:50",
      "airline": "ÂçóÊñπËà™Á©∫"
    },
    "highlights": [
      {
        "label": "Ê°ÉÂúíÊ©üÂ†¥Âá∫Áôº"
      },
      {
        "label": "ÊäµÈÅîÊ∑±Âú≥"
      },
      {
        "label": "Á¥†È£üÊôöÈ§ê"
      }
    ],
    "description": "<p>‰ªäÊó•ÈõÜÂêàÊñºÊ°ÉÂúíÂúãÈöõÊ©üÂ†¥ÔºåÊê≠Ê©üÈ£õÂæÄÊ∑±Âú≥ÔºåÁÇ∫ÂâçÂæÄÈùíËóèÈ´òÂéüÂâçÁöÑÈÅéÂ¢ÉË™øÊï¥Êó•„ÄÇ</p><p>ÊôöÈ§êÂÆâÊéíÁï∂Âú∞Á¥†È£üÊñôÁêÜÔºåÊèêÂâçÊÑüÂèóËèØÂçóÂüéÂ∏ÇÈ¢®Âë≥„ÄÇ</p>"
  },
  {
    "day": 2,
    "date": "2026-03-28",
    "title": "ÂàùÊäµÈ´òÂéüÔºöË•øËóèÊ±üÂçó",
    "locations": [
      "Ê∑±Âú≥",
      "ÊûóËäù"
    ],
    "altitude": {
      "avg": 3000,
      "max": 4720,
      "sleep": 2900
    },
    "coords": {
      "lat": 29.65,
      "lon": 94.3667
    },
    "weather_advice": "Ê∂ºÁàΩ (5-15¬∞C)ÔºåÊäµÈÅîÂæåÁ©øÈò≤È¢®Â§ñÂ•ó„ÄÇ",
    "stay": "ÊûóËäùÂçöÊ≥∞ÊûóËäùÂ§ßÈÖíÂ∫ó",
    "tips": "‰ªäÊó•Âãï‰ΩúË¶ÅÊÖ¢ÔºÅÂàáË®ò‰∏çË¶ÅÊ¥óÊæ°Ê¥óÈ†≠ÔºåÂ§öÂñùÊ∞¥„ÄÇ",
    "map_url": "https://www.google.com/maps/search/?api=1&query=ÊûóËäùÂçöÊ≥∞ÊûóËäùÂ§ßÈÖíÂ∫ó",
    "route": {
      "start": "ÊûóËäùÁ±≥ÊûóÊú∫Âú∫",
      "end": "È≤ÅÊúóÊûóÊµ∑È£éÊôØÂå∫",
      "waypoints": "ÈõÖÂ∞ºÂõΩÂÆ∂ÊπøÂú∞ÂÖ¨Âõ≠|Ëâ≤Â≠£ÊãâÂ±±Âè£",
      "mode": "driving"
    },
    "flight": {
      "code": "CZ5417",
      "from": "SZX Ê∑±Âú≥",
      "to": "LZY ÊûóËäù",
      "dep": "06:20",
      "arr": "11:00",
      "airline": "ÂçóÊñπËà™Á©∫"
    },
    "highlights": [
      {
        "label": "È£õË∂äÈõ™Â±±ÊäµÈÅîÊûóËäù"
      },
      {
        "label": "ÂìàÈÅîËøéË≥ì"
      },
      {
        "label": "ÈõÖÂ∞ºÊøïÂú∞"
      },
      {
        "label": "Ëâ≤Â≠£ÊãâÂ±±Âè£ (ËßÄÂçóËø¶Â∑¥Áì¶)",
        "url": "https://www.tibet.tw/gonglue/370.html"
      },
      {
        "label": "È≠ØÊúóÊûóÊµ∑",
        "url": "https://www.tibet.tw/gonglue/255.html"
      }
    ],
    "description": "<p>Ê∏ÖÊô®È£õÂæÄÊúâ„ÄåË•øËóèÊ±üÂçó„Äç‰πãÁ®±ÁöÑÊûóËäù„ÄÇÊäµÈÅîÂæåÁî±ËóèÊóèÂ∞éÈÅä‰ª•<b>ÂìàÈÅîËøéË≥ì</b>„ÄÇ</p><p>ÂâçÂæÄ<b>„ÄêÈõÖÂ∞ºÊøïÂú∞„Äë</b>Ëàá<b>„ÄêËâ≤Â≠£ÊãâÂ±±Âè£„Äë</b>ÔºåÂ§©Ê∞£Â•ΩÂèØÈÅ†Áú∫ÂçóËø¶Â∑¥Áì¶Â≥∞„ÄÇÊé•Ëëó‰æÜÂà∞<b>„ÄêÈ≠ØÊúóÊûóÊµ∑„Äë</b>ÔºåÊÑüÂèóÈ´òÂéüÊ£ÆÊûóÁöÑËä¨Â§öÁ≤æ„ÄÇ</p>"
  },
  {
    "day": 3,
    "date": "2026-03-29",
    "title": "ÂâçÂæÄËÅñÂüéÔºöÊûóÊãâÂÖ¨Ë∑Ø",
    "locations": [
      "ÊûóËäù",
      "ÊãâËñ©"
    ],
    "altitude": {
      "avg": 3200,
      "max": 5013,
      "sleep": 3650
    },
    "coords": {
      "lat": 29.6516,
      "lon": 91.1721
    },
    "weather_advice": "Êó•ÁÖßÂº∑ÔºåÂ¢®Èè°ÂøÖÂÇô„ÄÇ",
    "stay": "ÊãâËñ©ÁëûÂêâÂ∫¶ÂÅáÈÖíÂ∫ó",
    "tips": "‰ªäÊôöÂÖ•‰ΩèÊãâËñ© (3650m)ÔºåÂèØËÉΩÊúÉÈ†≠ÁóõÔºåÂ±¨Ê≠£Â∏∏ÁèæË±°„ÄÇ",
    "map_url": "https://www.google.com/maps/search/?api=1&query=ÊãâËñ©ÁëûÂêâÂ∫¶ÂÅáÈÖíÂ∫ó",
    "route": {
      "start": "ÊûóËäùÂ∏Ç",
      "end": "ÊãâËê®Â∏Ç",
      "waypoints": "Â∑¥ÊùæÊé™|Á±≥ÊãâÂ±±Âè£",
      "mode": "driving"
    },
    "highlights": [
      {
        "label": "ÊûóÊãâÊôØËßÄÂ§ßÈÅì"
      },
      {
        "label": "Ëâ≤ÊãâÂØ∫ (Á≤æÂΩ©ËæØÁ∂ì)",
        "url": "https://travel.line.me/article/4434"
      },
      {
        "label": "ÂÖ´ÂªìË°ó",
        "url": "https://www.tibet.tw/gonglue/383.html"
      },
      {
        "label": "ËóèË£ùÊóÖÊãçÈ´îÈ©ó (Âê´ÈÄ†ÂûãËàáÁ≤æ‰øÆ)"
      }
    ],
    "description": "<p>Ê≤øËëó„ÄåÊúÄÁæéÊôØËßÄÂ§ßÈÅì„ÄçÊûóÊãâÂÖ¨Ë∑ØÂâçÂæÄÊãâËñ©„ÄÇ</p><p>‰∏ãÂçàÂèÉËßÄ<b>„ÄêËâ≤ÊãâÂØ∫„Äë</b>ÔºåËã•Ê©üÁ∑£‰ø±Ë∂≥ÂèØÊ¨£Ë≥ûÁ≤æÂΩ©ÁöÑËæØÁ∂ìÂÑÄÂºè„ÄÇÊôö‰∏äÊº´Ê≠•<b>„ÄêÂÖ´ÂªìË°ó„Äë</b>Ôºå‰∏¶ÁâπÂà•ÂÆâÊéí<b>„ÄêËóèË£ùÊóÖÊãç„Äë(Âê´ÈÄ†ÂûãËàáÁ≤æ‰øÆ)</b>ÔºåÁïô‰∏ãÊúÄÁæéÁöÑÂõûÊÜ∂„ÄÇ</p>"
  },
  {
    "day": 4,
    "date": "2026-03-30",
    "title": "ËÅñÂüéÂ∑°Á¶ÆÔºö‰∏ñÁïåÈÅ∫Áî¢",
    "locations": [
      "ÊãâËñ©"
    ],
    "altitude": {
      "avg": 3650,
      "max": 3700,
      "sleep": 3650
    },
    "coords": {
      "lat": 29.6516,
      "lon": 91.1721
    },
    "weather_advice": "‰πæÁá•ÔºåÂä†Âº∑‰øùÊøïÈò≤Êõ¨„ÄÇ",
    "stay": "ÊãâËñ©ÁëûÂêâÂ∫¶ÂÅáÈÖíÂ∫ó",
    "tips": "Â∏ÉÈÅîÊãâÂÆÆÈöéÊ¢ØÂ§öÔºåË´ãË™øÊï¥ÂëºÂê∏Ôºå‰∏çË¶ÅÈÄûÂº∑„ÄÇ",
    "map_url": "https://www.google.com/maps/search/?api=1&query=ÊãâËñ©Â∏ÉÈÅîÊãâÂÆÆ",
    "route": {
      "start": "ÊãâËñ©ÁëûÂêâÂ∫¶ÂÅáÈÖíÂ∫ó",
      "end": "Â§ßÊò≠ÂØ∫",
      "waypoints": "Â∏ÉÈÅîÊãâÂÆÆ|Ëó•ÁéãÂ±±ËßÄÊôØÂè∞",
      "mode": "walking"
    },
    "highlights": [
      {
        "label": "Â∏ÉÈÅîÊãâÂÆÆ (ÂèÉËßÄÊîªÁï•)",
        "url": "https://www.findchina.tw/2021/12/potala-palace.html"
      },
      {
        "label": "Â§ßÊò≠ÂØ∫ (Ë¶∫Ê≤É‰Ωõ)",
        "url": "https://vocus.cc/article/69776507fd89780001a57cbf"
      },
      {
        "label": "Ëó•ÁéãÂ±±ËßÄÊôØÂè∞",
        "url": "https://www.chinatibet.tw/jingdian/566.html"
      }
    ],
    "description": "<p>‰ªäÊó•Ê∑±Â∫¶ÈÅäË¶Ω„ÄÇÊîÄÁôª world ÊúÄÈ´òÂÆÆÊÆø<b>„ÄêÂ∏ÉÈÅîÊãâÂÆÆ„Äë</b>Ôºå‰øØÁû∞ÊãâËñ©Âüé„ÄÇ</p><p>Èö®ÂæåÂèÉÊãúËóèÂÇ≥‰ΩõÊïô‰∏≠ÂøÉ<b>„ÄêÂ§ßÊò≠ÂØ∫„Äë</b>ÔºåÂú®<b>„ÄêËó•ÁéãÂ±±ËßÄÊôØÂè∞„Äë</b>ÊãçÊîùÂ∏ÉÈÅîÊãâÂÆÆÁ∂ìÂÖ∏ËßíÂ∫¶„ÄÇ</p>"
  },
  {
    "day": 5,
    "date": "2026-03-31",
    "title": "ËÅñÊπñËàáÂÜ∞Â∑ù",
    "locations": [
      "ÊãâËñ©",
      "ÁæäÊπñ",
      "Êó•ÂñÄÂâá"
    ],
    "altitude": {
      "avg": 4000,
      "max": 5030,
      "sleep": 3840
    },
    "coords": {
      "lat": 29.2667,
      "lon": 88.8833
    },
    "weather_advice": "Â±±Âè£È¢®Â§ßÔºåÊà¥ÊØõÂ∏ΩÂúçÂ∑æ„ÄÇ",
    "stay": "Êó•ÂñÄÂâáÂ∏åÁàæÈ†ìÈÖíÂ∫ó",
    "tips": "ÁøªË∂ä 5000m Â±±Âè£Ôºå‰∏ãËªäÊãçÁÖßÂãï‰ΩúË¶ÅÊÖ¢„ÄÇ",
    "map_url": "https://www.google.com/maps/search/?api=1&query=Êó•ÂñÄÂâáÂ∏åÁàæÈ†ìÈÖíÂ∫ó",
    "route": {
      "start": "ÊãâËê®Â∏Ç",
      "end": "Êó•ÂñÄÂàôÂ∏Ç",
      "waypoints": "ÁæäÂçìÈõçÊé™|Âç°Ëã•ÊãâÂÜ∞Â∑ù",
      "mode": "driving"
    },
    "highlights": [
      {
        "label": "Â¥óÂ∑¥ÊãâÂ±±Âè£"
      },
      {
        "label": "ÁæäÂçìÈõçÊé™ (ÊúÄÁæéËÅñÊπñ)",
        "url": "https://www.greattibettour.com/tw/tibet-attractions/yamdroktso-lake-365"
      },
      {
        "label": "Âç°Ëã•ÊãâÂÜ∞Â∑ù",
        "url": "https://www.travel168.com.tw/blogInfo?n=35"
      }
    ],
    "description": "<p>ÁøªË∂äÂ¥óÂ∑¥ÊãâÂ±±Âè£ÔºåÊäµÈÅîÁ¢ßËóçÁöÑ<b>„ÄêÁæäÂçìÈõçÊé™„Äë</b>ÔºåÂÆÉÊòØË•øËóè‰∏âÂ§ßËÅñÊπñ‰πã‰∏Ä„ÄÇ</p><p>ÈÄîÁ∂ìÂ£ØÈ∫óÁöÑ<b>„ÄêÂç°Ëã•ÊãâÂÜ∞Â∑ù„Äë</b>ÔºåÈÅ†Áú∫Ê±üÂ≠úÂÆóÂ±±Âè§Â†°ÔºåÂâçÂæÄÂæåËóèÈáçÈéÆÊó•ÂñÄÂâá„ÄÇ</p>"
  },
  {
    "day": 6,
    "date": "2026-04-01",
    "title": "Â∑îÂ≥∞ÊåëÊà∞ÔºöÁè†Â≥∞Â§ßÊú¨Ááü",
    "locations": [
      "Êó•ÂñÄÂâá",
      "Áè†Â≥∞"
    ],
    "altitude": {
      "avg": 4500,
      "max": 5200,
      "sleep": 5200
    },
    "coords": {
      "lat": 28.1408,
      "lon": 86.845
    },
    "weather_advice": "Ê•µÂØí (-10¬∞C)ÔºåÂÖ®ÂâØÊ≠¶Ë£ù„ÄÇ",
    "stay": "Áè†Â≥∞Â§ßÊú¨ÁáüÂ∏≥ÁØ∑/Ê∞ëÂÆø",
    "tips": "ÂÖ®Á®ãÊúÄÈ´òÊåëÊà∞ 5200m„ÄÇÈö®Ë∫´ÊîúÂ∏∂Ê∞ßÊ∞£Áì∂„ÄÇ",
    "map_url": "https://www.google.com/maps/search/?api=1&query=Áè†Â≥∞Â§ßÊú¨Ááü",
    "route": {
      "start": "Êó•ÂñÄÂàôÂ∏Ç",
      "end": "Áè†Á©ÜÊúóÁéõÂ≥∞Â§ßÊú¨Ëê•",
      "waypoints": "Âä†‰πåÊãâÂ±±Âè£|ÁªíÂ∏ÉÂØ∫",
      "mode": "driving"
    },
    "highlights": [
      {
        "label": "Âä†ÁÉèÊãâÂ±±Âè£ (8000mÈõ™Â±±Áæ§)",
        "url": "https://www.greattibettour.com/tw/tibet-attractions/gawu-la-pass.html"
      },
      {
        "label": "Áµ®Â∏ÉÂØ∫",
        "url": "https://vacation.eztravel.com.tw/sight/plc0000087590/rongbuk-monastery-%E7%B5%A8%E5%B8%83%E5%AF%BA"
      },
      {
        "label": "Áè†Â≥∞Â§ßÊú¨Ááü (‰ΩèÂÆøÊîªÁï•)",
        "url": "https://www.tibet.tw/gonglue/tibet-ebc-accommodation.html"
      }
    ],
    "description": "<p>ÈÄîÁ∂ì<b>„ÄêÂä†ÁÉèÊãâÂ±±Âè£„Äë</b>ÔºåÂ§©Ê∞£Â•ΩÈñãÂêåÊôÇÁúãË¶ã 4 Â∫ß 8000 Á±≥Á¥öÈõ™Â±±„ÄÇ</p><p>ÊäµÈÅî<b>„ÄêÁè†Â≥∞Â§ßÊú¨Ááü„Äë</b>ÔºåÂèÉÊãú‰∏ñÁïåÊúÄÈ´òÂØ∫Âªü<b>„ÄêÁµ®Â∏ÉÂØ∫„Äë</b>ÔºåÁ≠âÂæÖÈúáÊíºÁöÑÊó•ËêΩÈáëÂ±±„ÄÇ</p>"
  },
  {
    "day": 7,
    "date": "2026-04-02",
    "title": "ÂëäÂà•Áè†Â≥∞ÔºöËøîÂõûÊó•ÂñÄÂâá",
    "locations": [
      "Áè†Â≥∞",
      "Êó•ÂñÄÂâá"
    ],
    "altitude": {
      "avg": 4200,
      "max": 5200,
      "sleep": 3840
    },
    "coords": {
      "lat": 29.2667,
      "lon": 88.8833
    },
    "weather_advice": "Ê∏ÖÊô®Ê•µÂÜ∑ÔºåÂõûÊöñ„ÄÇ",
    "stay": "Êó•ÂñÄÂâáÂ∏åÁàæÈ†ìÈÖíÂ∫ó",
    "tips": "ÂõûÂà∞ 3840m ÊúÉË¶∫ÂæóÂëºÂê∏È†ÜÊö¢ÂæàÂ§öÔºå‰ªäÊôöÂ•ΩÂ•ΩÊ¥óÊæ°„ÄÇ",
    "map_url": "https://www.google.com/maps/search/?api=1&query=Êó•ÂñÄÂâáÂ∏åÁàæÈ†ìÈÖíÂ∫ó",
    "route": {
      "start": "Áè†Â≥∞Â§ßÊú¨Ëê•",
      "end": "Êâé‰ªÄ‰º¶Â∏ÉÂØ∫",
      "mode": "driving"
    },
    "highlights": [
      {
        "label": "Áè†Â≥∞Êó•Âá∫"
      },
      {
        "label": "Êâé‰ªÄÂÄ´Â∏ÉÂØ∫ (Ê≠∑‰ª£Áè≠Á¶™)",
        "url": "https://www.greattibettour.com/tw/tibet-attractions/tashilhunpo-monastery-369"
      }
    ],
    "description": "<p>Ëã•Â§©Ê∞£Ë®±ÂèØÔºåÊ¨£Ë≥ûÂÆåÁè†Â≥∞Êó•Âá∫Âæå‰∏ãÊí§„ÄÇ</p><p>ÂõûÂà∞Êó•ÂñÄÂâáÔºåÂèÉËßÄÁè≠Á¶™Â§ßÂ∏´ÈßêÈå´Âú∞<b>„ÄêÊâé‰ªÄÂÄ´Â∏ÉÂØ∫„Äë</b>ÔºåÊÑüÂèóËàáÂâçËóèÊà™ÁÑ∂‰∏çÂêåÁöÑÂØ∫Èô¢È¢®Ê†º„ÄÇ</p>"
  },
  {
    "day": 8,
    "date": "2026-04-03",
    "title": "Á©øË∂äËóèÂåó",
    "locations": [
      "Êó•ÂñÄÂâá",
      "Áï∂ÈõÑ"
    ],
    "altitude": {
      "avg": 4000,
      "max": 4500,
      "sleep": 4200
    },
    "coords": {
      "lat": 30.4833,
      "lon": 91.1
    },
    "weather_advice": "ËçâÂéüÈ¢®Â§ß‰πæÁá•„ÄÇ",
    "stay": "Áï∂ÈõÑÂõõÂ≠£ÂØåÊ∞ßÈÖíÂ∫ó",
    "tips": "Áï∂ÈõÑÊµ∑Êãî 4200m ‰ªçÈ´òÔºåÊ≥®ÊÑè‰øùÊöñ„ÄÇ",
    "map_url": "https://www.google.com/maps/search/?api=1&query=Áï∂ÈõÑÂõõÂ≠£ÂØåÊ∞ßÈÖíÂ∫ó",
    "route": {
      "start": "Êó•ÂñÄÂàôÂ∏Ç",
      "end": "ÂΩìÈõÑÁ´ô",
      "waypoints": "Èõ™Âè§ÊãâÂ±±",
      "mode": "driving"
    },
    "highlights": [
      {
        "label": "ËóèÂåóËçâÂéüÈ¢®ÂÖâ"
      },
      {
        "label": "Èõ™Âè§ÊãâÂ±±Âè£"
      },
      {
        "label": "Áï∂ÈõÑ (Á¥çÊú®Êé™ÈñÄÊà∂)"
      }
    ],
    "description": "<p>‰ªäÊó•Ê≤øËëóËóèÂåóÁ∑öÂâçË°åÔºåÊ¨£Ë≥ûÈÅºÈóäÁöÑËçâÂéüÈ¢®ÂÖâËàáÊàêÁæ§ÁöÑÁâõÁæä„ÄÇ</p><p>ÁøªË∂äÈõ™Âè§ÊãâÂ±±Âè£ÔºåÊäµÈÅîÁ¥çÊú®Êé™ÁöÑÈñÄÊà∂‚Äî‚ÄîÁï∂ÈõÑÁ∏£„ÄÇ</p>"
  },
  {
    "day": 9,
    "date": "2026-04-04",
    "title": "Â§©ÊπñÁ¥çÊú®Êé™",
    "locations": [
      "Áï∂ÈõÑ",
      "Á¥çÊú®Êé™",
      "ÊãâËñ©"
    ],
    "altitude": {
      "avg": 4000,
      "max": 5190,
      "sleep": 3650
    },
    "coords": {
      "lat": 30.72,
      "lon": 90.96
    },
    "weather_advice": "ÊπñÈÇäÈ¢®Â¶ÇÂàÄÂâ≤ÔºåÊ•µÂÜ∑„ÄÇ",
    "stay": "ÊãâËñ©ÁëûÂêâÂ∫¶ÂÅáÈÖíÂ∫ó",
    "tips": "Ë°åÁ®ãÊúÄÂæåÁöÑÈ´òÊµ∑ÊãîÊåëÊà∞„ÄÇÊôö‰∏äÁúãÁßÄÊ≥®ÊÑè‰øùÊöñ„ÄÇ",
    "map_url": "https://www.google.com/maps/search/?api=1&query=ÊãâËñ©ÁëûÂêâÂ∫¶ÂÅáÈÖíÂ∫ó",
    "route": {
      "start": "ÊãâËê®Â∏Ç",
      "end": "Á∫≥Êú®Èîô",
      "mode": "driving"
    },
    "highlights": [
      {
        "label": "ÈÇ£Ê†πÊãâÂ±±Âè£"
      },
      {
        "label": "Á¥çÊú®Êé™ (Â§©Êπñ)",
        "url": "https://www.chinatibet.tw/jingdian/130.html"
      },
      {
        "label": "ÊñáÊàêÂÖ¨‰∏ªÂØ¶ÊôØÂäá",
        "url": "https://www.sunnyhousetours.com/chinese/explore/detail.php?PID=412"
      }
    ],
    "description": "<p>ÁøªË∂äÈÇ£Ê†πÊãâÂ±±Âè£ÔºåÊäµÈÅîÂ§©Êπñ<b>„ÄêÁ¥çÊú®Êé™„Äë</b>ÔºåÊÑüÂèóÊµ∑Â§©‰∏ÄËâ≤ÁöÑÈúáÊíº„ÄÇ</p><p>ËøîÂõûÊãâËñ©ÔºåÊôöÈñìÊ¨£Ë≥ûÂ§ßÂûãÂØ¶ÊôØÂäá<b>„ÄäÊñáÊàêÂÖ¨‰∏ª„Äã</b>„ÄÇ</p>"
  },
  {
    "day": 10,
    "date": "2026-04-05",
    "title": "ÈùíËóèÈêµË∑Ø",
    "locations": [
      "ÊãâËñ©",
      "ÁÅ´Ëªä‰∏ä"
    ],
    "altitude": {
      "avg": 4000,
      "max": 5072,
      "sleep": 3000
    },
    "coords": {
      "lat": 32.7,
      "lon": 92.4333
    },
    "weather_advice": "ËªäÂÖßËàíÈÅ©ÔºåËªäÂ§ñÂØíÂÜ∑„ÄÇ",
    "stay": "ÈùíËóèÈêµË∑ØËªüËá•",
    "tips": "ÁÅ´Ëªä‰∏äÊúâ‰æõÊ∞ß. ÊîæÈ¨ÜÊ¨£Ë≥ûÁ™óÂ§ñÊµÅÂãïÁöÑÈ¢®ÊôØÂ§ßÁâá„ÄÇ",
    "map_url": "https://www.google.com/maps/search/?api=1&query=ÊãâËñ©ÁÅ´ËªäÁ´ô",
    "route": {
      "end": "ÊãâËê®ÁÅ´ËΩ¶Á´ô",
      "mode": "train"
    },
    "highlights": [
      {
        "label": "ÈùíËóèÈêµË∑Ø (Ê≤øÈÄîÁæéÊôØ)",
        "url": "https://www.findchina.tw/2021/12/qinghai-tibet-railway-guide.html"
      },
      {
        "label": "ÂîêÂè§ÊãâÂ±±Âè£",
        "url": "https://vacation.eztravel.com.tw/sight/plc0000088371/tanggula-pass-%E5%94%90%E5%8F%A4%E6%8B%89%E5%B1%B1%E5%8F%A3"
      },
      {
        "label": "ÂèØÂèØË•øÈáå (ËóèÁæöÁæä)",
        "url": "https://www.greattibettour.com/tw/tibet-travel-tips/tibetan-antelope.html"
      }
    ],
    "description": "<p>Êê≠‰πò<b>„ÄêÈùíËóèÈêµË∑Ø„Äë</b>ËªüËá•ÂàóËªäÔºåÁ©øË∂ä‰∏ñÁïåÂ±ãËÑä„ÄÇ</p><p>Ê≤øÈÄîÁ∂ìÈÅéÂîêÂè§ÊãâÂ±±Âè£„ÄÅÂèØÂèØË•øÈáåÁÑ°‰∫∫ÂçÄÔºåÊúâÊ©üÊúÉÁúãÂà∞ËóèÁæöÁæäÁ≠âÈáéÁîüÂãïÁâ©„ÄÇ</p>"
  },
  {
    "day": 11,
    "date": "2026-04-06",
    "title": "ÊäµÈÅîË•øÂØßÔºöËΩâÊ©ü",
    "locations": [
      "Ë•øÂØß",
      "Âª£Â∑û"
    ],
    "altitude": {
      "avg": 2200,
      "max": 3000,
      "sleep": 50
    },
    "coords": {
      "lat": 36.6209,
      "lon": 101.7801
    },
    "weather_advice": "ÊäµÈÅîÂª£Â∑ûÂæåËÆäÁÜ±„ÄÇ",
    "stay": "Âª£Â∑ûËä±ÈÉΩÁôΩÈõ≤ÂúãÈöõÊ©üÂ†¥ÈÄ∏ÊââÈÖíÂ∫ó",
    "tips": "ÂõûÂà∞Âπ≥ÂéüÂèØËÉΩÊúÉÂóúÁù°ÔºåÂ•ΩÂ•Ω‰ºëÊÅØ„ÄÇ",
    "map_url": "https://www.google.com/maps/search/?api=1&query=Âª£Â∑ûËä±ÈÉΩÁôΩÈõ≤ÂúãÈöõÊ©üÂ†¥ÈÄ∏ÊââÈÖíÂ∫ó",
    "route": {
      "end": "ÂπøÂ∑ûÁôΩ‰∫ëÂõΩÈôÖÊú∫Âú∫",
      "mode": "flight"
    },
    "flight": {
      "code": "CZ6394",
      "from": "XNN Ë•øÂØß",
      "to": "CAN Âª£Â∑û",
      "dep": "16:15",
      "arr": "21:10",
      "airline": "ÂçóÊñπËà™Á©∫"
    },
    "highlights": [
      {
        "label": "ÈùíÊµ∑ÊπñÈÅ†Áú∫"
      },
      {
        "label": "Ë•øÂØßÂ∏ÇÂçÄ"
      }
    ],
    "description": "<p>ÁÅ´ËªäÊäµÈÅîË•øÂØß. Ë¶ñÊôÇÈñìÂÆâÊéíÂ∏ÇÂçÄÈÅäË¶ΩÔºåÈö®ÂæåÂâçÂæÄÊ©üÂ†¥ËΩâÊ©üÈ£õÂæÄÂª£Â∑û„ÄÇ</p>"
  },
  {
    "day": 12,
    "date": "2026-04-07",
    "title": "ÊªøËºâËÄåÊ≠∏",
    "locations": [
      "Âª£Â∑û",
      "Ê°ÉÂúí"
    ],
    "altitude": {
      "avg": 50,
      "max": 50,
      "sleep": 50
    },
    "coords": {
      "lat": 23.1291,
      "lon": 113.2644
    },
    "weather_advice": "Ê∫´ÊöñËàíÈÅ©„ÄÇ",
    "stay": "ÁîúËúúÁöÑÂÆ∂",
    "tips": "Êï¥ÁêÜÁÖßÁâáÔºåÂàÜ‰∫´Ë•øËóèÂõûÊÜ∂ÔºÅ",
    "map_url": "https://www.google.com/maps/search/?api=1&query=Ê°ÉÂúíÂúãÈöõÊ©üÂ†¥",
    "route": {
      "end": "Ê°ÉÂõ≠ÂõΩÈôÖÊú∫Âú∫",
      "mode": "flight"
    },
    "flight": {
      "code": "CZ3097",
      "from": "CAN Âª£Â∑û",
      "to": "TPE Ê°ÉÂúí",
      "dep": "11:15",
      "arr": "13:30",
      "airline": "ÂçóÊñπËà™Á©∫"
    },
    "highlights": [
      {
        "label": "Âª£Â∑ûÁôΩÈõ≤Ê©üÂ†¥"
      },
      {
        "label": "ÊäµÈÅîÊ°ÉÂúíÊ©üÂ†¥"
      }
    ],
    "description": "<p>‰∫´Áî®Êó©È§êÂæåÂâçÂæÄÊ©üÂ†¥ÔºåÊê≠Ê©üËøîÂõûÊ°ÉÂúíÔºåÁµêÊùüÈõ£ÂøòÁöÑË•øËóè‰πãÊóÖ„ÄÇ</p>"
  }
];

        createApp({
            setup() {
                const itinerary = ref([]);
                const currentIndex = ref(0);
                const loading = ref(true); // Still keep loading state for visual consistency
                const error = ref(null);
                const isDrawerOpen = ref(false);
                const isManualOpen = ref(false);
                const liveWeather = ref(null);
                const weatherLoading = ref(false);
                const countdown = ref(0);

                const updateCountdown = () => {
                    const target = new Date('2026-03-27T00:00:00');
                    const now = new Date();
                    const diff = target - now;
                    countdown.value = Math.ceil(diff / (1000 * 60 * 60 * 24));
                };

                const enterApp = () => {
                    currentIndex.value = 0; // Reset to Day 1
                    const lp = document.getElementById('landing-page');
                    if (lp) {
                        lp.classList.add('transition-all', 'duration-500', 'opacity-0', 'pointer-events-none');
                        setTimeout(() => lp.style.display = 'none', 500);
                    }
                };

                const fetchLiveWeather = async (lat, lon) => {
                    if (!lat || !lon) {
                        liveWeather.value = null;
                        return;
                    }
                    weatherLoading.value = true;
                    try {
                        const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,precipitation_probability&daily=sunrise,sunset&timezone=auto`;
                        const res = await fetch(url);
                        const data = await res.json();
                        const formatTime = (isoStr) => {
                            if (!isoStr) return '---';
                            return isoStr.split('T')[1].substring(0, 5);
                        };

                        liveWeather.value = {
                            temp: Math.round(data.current.temperature_2m),
                            rain: data.current.precipitation_probability,
                            sunrise: formatTime(data.daily.sunrise[0]),
                            sunset: formatTime(data.daily.sunset[0])
                        };
                    } catch (err) {
                        console.error("Weather fetch failed:", err);
                        liveWeather.value = null;
                    } finally {
                        weatherLoading.value = false;
                    }
                };

                watch(currentIndex, () => {
                    if (currentDay.value && currentDay.value.coords) {
                        fetchLiveWeather(currentDay.value.coords.lat, currentDay.value.coords.lon);
                    } else {
                        liveWeather.value = null;
                    }
                });

                // Toolkit Logic (V5.0)
                const isToolkitOpen = ref(false);
                const toolkitView = ref('main'); // main, sos, tibetan, breathing, packing
                const fullscreenPhrase = ref(null);
                const breathingText = ref('Ê∫ñÂÇôÈñãÂßã');
                const breathingSubtext = ref('Âç≥Â∞áÈñãÂßãÂëºÂê∏ÂºïÂ∞é');
                const breathingIcon = ref('air');
                const breathingStateClass = ref('');
                let breathingTimer = null;

                const tibetanPhrases = [
                    { ch: "‰Ω†Â•Ω", tib: "Tashi Delek", pron: "ÊâéË•ø Âæ∑Âãí", urgent: false },
                    { ch: "Ë¨ùË¨ù", tib: "Thu-chi-che", pron: "Á™ÅÂÖ∂Âàá", urgent: false },
                    { ch: "Êàë‰∏çËàíÊúç", tib: "Nga De-po Min-dug", pron: "Êãø ÂæóÊ≥¢ Ê∞ëÂ∫¶", urgent: true },
                    { ch: "ÊàëË¶ÅÂéªÈÜ´Èô¢", tib: "Nga Men-khang La Dro-gi Yin", pron: "Êãø ÊõºÂ∫∑ Êãâ ÂçìÂêâ Âõ†", urgent: true },
                    { ch: "ÂªÅÊâÄÂú®Âì™Ë£°Ôºü", tib: "Sang-chod Ka-par Yod?", pron: "Ê°ëÊ±∫ ÂòéÂ∑¥ Êúâ?", urgent: false },
                    { ch: "ÈÄôË£°Êµ∑ÊãîÂ§öÂ∞ëÔºü", tib: "Di Sa-cha Sa-tho Tshad Ga-tshod Red?", pron: "Êª¥ ÊííÊ¥Ω ÊííËÑ´ Ëî° ÂòéÂàá Áëû", urgent: false }
                ];

                const toggleToolkit = () => {
                    isToolkitOpen.value = !isToolkitOpen.value;
                    toolkitView.value = 'main';
                    fullscreenPhrase.value = null;
                    if (breathingTimer) {
                        clearInterval(breathingTimer);
                        breathingTimer = null;
                        breathingText.value = 'Ê∫ñÂÇôÈñãÂßã';
                        breathingSubtext.value = 'Âç≥Â∞áÈñãÂßãÂëºÂê∏ÂºïÂ∞é';
                        breathingIcon.value = 'air';
                        breathingStateClass.value = '';
                    }
                };

                const startBreathing = () => {
                    toolkitView.value = 'breathing';
                    let step = 0;
                    const runStep = () => {
                        if (step === 0) { // Inhale
                            breathingText.value = 'Âê∏Ê∞£ (Inhale)';
                            breathingSubtext.value = 'ÊÖ¢ÊÖ¢Âê∏ÂÖ•ÂÜ∑ÂÜΩÊ∏ÖÊñ∞ÁöÑÁ©∫Ê∞£';
                            breathingIcon.value = 'expand';
                            breathingStateClass.value = 'breathing-inhale';
                            step = 1;
                        } else if (step === 1) { // Hold
                            breathingText.value = 'ÊÜãÊ∞£ (Hold)';
                            breathingSubtext.value = 'ÊÑüÂèóÊ∞£ÊÅØÂú®È´îÂÖßÊµÅÂãï';
                            breathingIcon.value = 'pause';
                            breathingStateClass.value = 'breathing-hold';
                            step = 2;
                        } else { // Exhale
                            breathingText.value = 'ÂêêÊ∞£ (Exhale)';
                            breathingSubtext.value = 'Â∏∂Ëµ∞Áñ≤ÊÜä Èôç‰ΩéÂ£ìÂäõ';
                            breathingIcon.value = 'compress';
                            breathingStateClass.value = 'breathing-exhale';
                            step = 0;
                        }
                    };
                    runStep(); // Run first step immediately
                    breathingTimer = setInterval(runStep, 4000); // Then repeat every 4 seconds
                };

                const stopBreathing = () => {
                    if (breathingTimer) {
                        clearInterval(breathingTimer);
                        breathingTimer = null;
                    }
                    toolkitView.value = 'main';
                    breathingText.value = 'Ê∫ñÂÇôÈñãÂßã';
                    breathingSubtext.value = 'Âç≥Â∞áÈñãÂßãÂëºÂê∏ÂºïÂ∞é';
                    breathingIcon.value = 'air';
                    breathingStateClass.value = '';
                };

                // Expose resetToDayOne globally so landing page can call it
                window.resetToDayOne = () => {
                    currentIndex.value = 0;
                    window.scrollTo({ top: 0, behavior: 'smooth' }); // Also scroll to top
                };
                const simulatedToday = '2026-04-01';
                const width = ref(window.innerWidth);

                const onResize = () => {
                    width.value = window.innerWidth;
                    if (width.value >= 768) {
                        isDrawerOpen.value = false;
                    }
                };

                // Packing List Data & Logic (V4.0)
                const packingList = ref([
                    { category: 'ÂøÖÂÇôË≠â‰ª∂', items: ['Ë≠∑ÁÖß/Âè∞ËÉûË≠â', 'ÂÖ•ËóèÂáΩ (Ê≠£Êú¨)', 'Ê©üÁ•®/ÁÅ´ËªäÁ•®', 'ÁèæÈáë/‰ø°Áî®Âç°'] },
                    { category: 'ÈõªÂ≠êÁî¢ÂìÅ', items: ['ÊâãÊ©ü & ÂÖÖÈõªÁ∑ö', 'Ë°åÂãïÈõªÊ∫ê (‚ö†Ô∏è È†àÊúâÊ∏ÖÊô∞ÂÆπÈáèÊ®ôÁ§∫)', 'ËÆäÂ£ìÂô®/ËΩâÊé•È†≠ (‰∏≠ÂúãÈõªÂ£ì220V)', 'Á∂≤Âç°/WifiÊ©ü (ÊóÖË°åÁ§æÂ∑≤Ë¥àÈÄÅ)'] },
                    { category: 'ÂÄã‰∫∫Ëó•ÂìÅ', items: ['Á¥ÖÊôØÂ§© (ÊèêÂâçÂêÉ)', '‰∏πÊú®ÊñØ (È´òÂ±±Áóá)', 'ÊÑüÂÜí/ËÖ∏ËÉÉËó•', 'Á∂≠‰ªñÂëΩ/BÁæ§'] },
                    { category: 'Ë°£Áâ©Ë£ùÂÇô', items: ['ÁæΩÁµ®Â§ñÂ•ó (Èò≤È¢®Èò≤Ê∞¥)', 'ÊØõÂ∏Ω & ÂúçÂ∑æ', 'Â¢®Èè° (ÂÅèÂÖâ)', '‰øùÊöñÂ•ΩËµ∞Èûã'] },
                    { category: 'Êó•Áî®ÂìÅ', items: ['‰øùÊøï‰π≥Ê∂≤/Ë≠∑ÂîáËÜè', 'Èò≤Êõ¨‰π≥ (È´ò‰øÇÊï∏)', '‰øùÊ∫´Áì∂', 'ÊøïÁ¥ôÂ∑æ/Ë°õÁîüÁ¥ô'] }
                ]);
                const isPackingListOpen = ref(false); // Used for backward compatibility or direct access if needed


                const packedItems = ref({});

                const loadPackingStatus = () => {
                    try {
                        const stored = localStorage.getItem('tibet_packing_v1');
                        if (stored) {
                            packedItems.value = JSON.parse(stored);
                        } else {
                            // V12.0 Default: Check travel agency gift
                            packedItems.value = { "ÈõªÂ≠êÁî¢ÂìÅ_Á∂≤Âç°/WifiÊ©ü (ÊóÖË°åÁ§æÂ∑≤Ë¥àÈÄÅ)": true };
                            savePackingStatus();
                        }
                    } catch (e) {
                        console.error('Failed to load packing list', e);
                    }
                };

                const savePackingStatus = () => {
                    localStorage.setItem('tibet_packing_v1', JSON.stringify(packedItems.value));
                };

                const isPacked = (category, item) => {
                    const key = `${category}_${item}`;
                    return !!packedItems.value[key];
                };

                const togglePackingItem = (category, item) => {
                    const key = `${category}_${item}`;
                    if (packedItems.value[key]) {
                        delete packedItems.value[key];
                    } else {
                        packedItems.value[key] = true;
                    }
                    savePackingStatus();
                };

                // Health Tracker Logic (V3.2)
                const healthRecords = ref([]);
                const newSpo2 = ref('');
                const newHr = ref('');

                const loadHealthData = () => {
                    const stored = localStorage.getItem('tibet_health_v1');
                    if (stored) {
                        try {
                            healthRecords.value = JSON.parse(stored);
                        } catch (e) {
                            console.error("Failed to parse health records", e);
                            healthRecords.value = [];
                        }
                    }
                };

                const saveHealthData = () => {
                    localStorage.setItem('tibet_health_v1', JSON.stringify(healthRecords.value));
                };

                const currentDateRecords = computed(() => {
                    if (!currentDay.value) return [];
                    return healthRecords.value
                        .filter(r => r.date === currentDay.value.date)
                        .sort((a, b) => b.id - a.id); // Newest first
                });

                const addHealthRecord = () => {
                    if (!newSpo2.value || !newHr.value) return;
                    if (newSpo2.value < 0 || newSpo2.value > 100) {
                        alert('SpO2 Êï∏ÂÄº‰∏çÊ≠£Á¢∫ (0-100)');
                        return;
                    }

                    const now = new Date();
                    const record = {
                        id: Date.now(),
                        date: currentDay.value.date,
                        time: now.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit', hour12: false }),
                        spo2: newSpo2.value,
                        hr: newHr.value
                    };

                    healthRecords.value.push(record);
                    saveHealthData();
                    newSpo2.value = '';
                    newHr.value = '';
                };

                const deleteHealthRecord = (id) => {
                    if (confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÁ≠ÜÁ¥ÄÈåÑÂóéÔºü')) {
                        healthRecords.value = healthRecords.value.filter(r => r.id !== id);
                        saveHealthData();
                    }
                };

                const copyHealthRecords = () => {
                    if (currentDateRecords.value.length === 0) {
                        alert('‰ªäÊó•Â∞öÁÑ°Á¥ÄÈåÑÂèØË§áË£Ω');
                        return;
                    }

                    const dateStr = currentDay.value.date;
                    const lines = currentDateRecords.value.map(r =>
                        `${r.time} SpO2:${r.spo2}% HR:${r.hr}bpm`
                    );
                    // Reverse to show oldest first in text list? Or keeps newest first?
                    // Usually logs are chronological for reading. Let's reverse for copy.
                    const textLines = [...lines].reverse();

                    const text = `üìÖ ${dateStr} ÂÅ•Â∫∑Á¥ÄÈåÑ\n` + textLines.join('\n');

                    navigator.clipboard.writeText(text).then(() => {
                        alert('‚úÖ Â∑≤Ë§áË£ΩÂà∞Ââ™Ë≤ºÁ∞øÔºÅ');
                    }).catch(err => {
                        alert('Ë§áË£ΩÂ§±Êïó');
                    });
                };

                // Audio Pronunciation (V9.2)
                const speak = (phrase) => {
                    if (!window.speechSynthesis) return;
                    window.speechSynthesis.cancel();

                    // Tibetan tone simulation: slightly lower pitch, slower pace, and resonant
                    const msg = new SpeechSynthesisUtterance(phrase.pron);
                    msg.lang = 'zh-TW';
                    msg.rate = 0.75;  // More deliberate pace
                    msg.pitch = 0.85; // Lower resonance
                    msg.volume = 1;

                    window.speechSynthesis.speak(msg);
                };

                // Initialize Data
                const init = () => {
                    try {
                        loading.value = true;
                        // Use inline data
                        itinerary.value = itineraryData;
                        resetToToday();
                    } catch (e) {
                        console.error(e);
                        error.value = "Ë≥áÊñôËºâÂÖ•Â§±Êïó: " + e.message;
                    } finally {
                        loading.value = false;
                    }
                };

                const currentDay = computed(() => {
                    if (itinerary.value.length === 0) return null;
                    return itinerary.value[currentIndex.value];
                });

                const isHighAltitude = computed(() => {
                    if (!currentDay.value) return false;
                    return currentDay.value.altitude.max > 3500 || currentDay.value.altitude.sleep > 3500;
                });

                const isToday = computed(() => {
                    if (!currentDay.value) return false;
                    return currentDay.value.date === simulatedToday;
                });

                const formattedLocations = computed(() => {
                    if (!currentDay.value) return '';
                    return currentDay.value.locations.join(' ‚ûù ');
                });

                const mapButtonInfo = computed(() => {
                    if (!currentDay.value) return null;
                    const day = currentDay.value;
                    if (!day.route) {
                        return {
                            url: day.map_url || '',
                            label: 'ÈñãÂïüÂú∞Âúñ',
                            icon: 'map'
                        };
                    }

                    let url = '';
                    let label = '';
                    let icon = '';

                    const start = day.route.start;
                    const end = day.route.end;

                    if (day.route.mode === 'driving') {
                        // Baidu Maps Web Direction - V11.4 Simplified (No waypoints to ensure 100% load)
                        url = `http://api.map.baidu.com/direction?origin=${start}&destination=${end}&mode=driving&region=Ë•øËóè&output=html&src=webapp.tibet_companion`;
                        label = 'üöó Êü•ÁúãË∑ØÁ∑ö (ÁôæÂ∫¶Âú∞Âúñ)';
                        icon = 'directions_car';
                    } else if (day.route.mode === 'walking') {
                        // Google Maps Walking
                        const origin = encodeURIComponent(start);
                        const destination = encodeURIComponent(end);
                        let params = `api=1&origin=${origin}&destination=${destination}&travelmode=walking`;
                        if (day.route.waypoints) {
                            const wps = day.route.waypoints.split('|').map(w => encodeURIComponent(w)).join('|');
                            params += `&waypoints=${wps}`;
                        }
                        url = `https://www.google.com/maps/dir/?${params}`;
                        label = 'üö∂ Â∏ÇÂçÄÂ∞éË¶Ω (Google)';
                        icon = 'directions_walk';
                    } else if (day.route.mode === 'train_route') {
                        // Special: Qinghai-Tibet Railway Simulation (Hidden driving route)
                        url = `http://api.map.baidu.com/direction?origin=${start}&destination=${end}&mode=driving&region=Ë•øËóè&output=html&src=webapp.tibet_companion`;
                        label = 'üöÇ Êü•ÁúãÈùíËóèÈêµË∑ØË∑ØÁ∑ö (ÁôæÂ∫¶)';
                        icon = 'train';
                    } else {
                        // Fixed point (Flight/Train)
                        url = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(end)}`;
                        label = day.route.mode === 'train' ? 'üöÇ Êü•ÁúãËªäÁ´ô‰ΩçÁΩÆ' : '‚úàÔ∏è Êü•ÁúãÊ©üÂ†¥‰ΩçÁΩÆ';
                        icon = day.route.mode === 'train' ? 'train' : 'flight_takeoff';
                    }

                    return { url, label, icon };
                });

                const openMap = (day) => {
                    if (mapButtonInfo.value && mapButtonInfo.value.url) {
                        window.open(mapButtonInfo.value.url, '_blank');
                    }
                };

                const changeDay = (delta) => {
                    const newIndex = currentIndex.value + delta;
                    if (newIndex >= 0 && newIndex < itinerary.value.length) {
                        currentIndex.value = newIndex;
                        const scrollContainer = document.getElementById('main-content-scroll');
                        if (scrollContainer) scrollContainer.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                };

                const selectDay = (index) => {
                    currentIndex.value = index;
                    isDrawerOpen.value = false;
                    const scrollContainer = document.getElementById('main-content-scroll');
                    if (scrollContainer) scrollContainer.scrollTo({ top: 0, behavior: 'smooth' });
                };

                const resetToToday = () => {
                    const foundIndex = itinerary.value.findIndex(d => d.date === simulatedToday);
                    if (foundIndex !== -1) {
                        currentIndex.value = foundIndex;
                    } else {
                        currentIndex.value = 0;
                    }
                };

                onMounted(() => {
                    updateCountdown();
                    init();
                    loadHealthData();
                    loadPackingStatus();
                    window.addEventListener('resize', onResize);
                });

                onUnmounted(() => {
                    window.removeEventListener('resize', onResize);
                });


                return {
                    itinerary,
                    currentIndex,
                    currentDay,
                    loading,
                    error,
                    isHighAltitude,
                    isToday,
                    isDrawerOpen,
                    width,
                    openMap,
                    changeDay,
                    selectDay,
                    resetToToday,
                    formattedLocations,
                    mapButtonInfo,
                    isManualOpen,
                    // Health Tracker
                    healthRecords,
                    newSpo2,
                    newHr,
                    currentDateRecords,
                    addHealthRecord,
                    deleteHealthRecord,
                    copyHealthRecords,
                    // Packing List
                    isPackingListOpen,
                    packingList,
                    packedItems,
                    isPacked,
                    togglePackingItem,
                    // Toolkit
                    isToolkitOpen,
                    toolkitView,
                    toggleToolkit,
                    tibetanPhrases,
                    fullscreenPhrase,
                    breathingText,
                    breathingSubtext,
                    breathingIcon,
                    breathingStateClass,
                    startBreathing,
                    stopBreathing,
                    speak,
                    countdown,
                    enterApp,
                    // Weather
                    liveWeather,
                    weatherLoading
                };
            }
        }).mount('#app');
    </script>
</body>

</html>